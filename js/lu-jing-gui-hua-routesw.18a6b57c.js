"use strict";(self["webpackChunksun_glare_project"]=self["webpackChunksun_glare_project"]||[]).push([[3256],{51197:function(e,t,i){i.d(t,{JA:function(){return l},Lk:function(){return u},YK:function(){return n},d5:function(){return d},dn:function(){return o},eE:function(){return h},y9:function(){return s},zJ:function(){return r}});var a=i(56768);function s(e,t){if(e.searchResults.length&&e.searchQueryStart)switch(t.key){case"Escape":e.searchResults=[];break;case"Tab":t.preventDefault(),e.highlightedIndex=(e.highlightedIndex+1)%e.searchResults.length,(0,a.dY)((()=>{const t=e.$refs.searchResultsStart.querySelector("li.highlighted");t&&t.scrollIntoView({block:"nearest",behavior:"smooth"})}));break;case"Enter":e.highlightedIndex>=0&&e.highlightedIndex<e.searchResults.length&&e.selectResult(e.searchResults[e.highlightedIndex],!0);break}else if(e.searchResultsEnd.length&&e.searchQueryEnd)switch(t.key){case"Escape":e.searchResultsEnd=[];break;case"Tab":t.preventDefault(),e.highlightedIndex=(e.highlightedIndex+1)%e.searchResultsEnd.length,(0,a.dY)((()=>{const t=e.$refs.searchResultsEnd.querySelector("li.highlighted");t&&t.scrollIntoView({block:"nearest",behavior:"smooth"})}));break;case"Enter":e.highlightedIndex>=0&&e.highlightedIndex<e.searchResultsEnd.length&&e.selectResult(e.searchResultsEnd[e.highlightedIndex],!1);break}}function l(e){const t=new Date,i=`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`;e.isTimeFromUrl&&e.selectedTime!==i||(e.selectedTime=i,e.isTimeFromUrl=!1)}function n(e){e.searchQueryStart=""}function o(e){e.searchQueryEnd=""}function r(e,t){if(!t)return!1;const i=new Date(t),a=i.getMonth()+1,s=i.getDate();return a>=1&&a<=7&&15!==s||(8===a&&s<=25||((10===a||12===a)&&15!==s||11===a&&s>=9))}function d(e,t){const i=t.target.value;r(e,i)&&(alert("抱歉，选择的日期未进行模拟，请选择其他日期。可选日期为，9月1日-9月30日，11月1日到9日，以及其他月份的15日."),e.selectedDate="")}function u(e,t){const i=t.target.value,[a,s]=i.split(":").map(Number),l=10*Math.floor(s/10);e.selectedTime=`${String(a).padStart(2,"0")}:${String(l).padStart(2,"0")}`}function h(e,t,i){const a=t.target.value,s=i?"searchResults":"searchResultsEnd";a.includes("'")||(a.length>=2?fetch("https://dce4-2001-da8-2019-b282-14c-86be-f57b-b795.ngrok-free.app/api/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({searchQueryStart:a})}).then((e=>e.json())).then((t=>{e[s]=t})).catch((e=>{console.error("错误:",e)})):e[s]=[])}},73241:function(e,t,i){i.d(t,{Dk:function(){return a},U:function(){return s},oU:function(){return l},uG:function(){return n},wf:function(){return d},wg:function(){return u}});i(44114),i(14603),i(47566),i(98721);function a(e){const t=new URLSearchParams(window.location.search),i=t.get("start"),a=t.get("end"),s=t.get("date"),l=t.get("time"),n=t.get("default_id"),o=t.get("time_based_id");if(i)try{const t=JSON.parse(decodeURIComponent(i));t&&t.address&&(e.searchQueryStart=t.name)}catch(r){console.error("Error parsing start parameter:",r)}if(a)try{const t=JSON.parse(decodeURIComponent(a));t&&t.address&&(e.searchQueryEnd=t.name)}catch(r){console.error("Error parsing end parameter:",r)}s&&(e.selectedDate=s),l&&(e.selectedTime=l,e.isTimeFromUrl=!0),n&&(e.defaultRouteId=n),o&&(e.timeBasedRouteId=o),e.created()}function s(e){e.isRouteListVisible=!e.isRouteListVisible}function l(e){return 0===e?"rgb(25, 202, 173)":1===e?"rgb(244, 96, 108)":"black"}function n(e,t){t="defaultRouteId"===t?"noGlareRouteId":"defaultRouteId",e.highlightedRouteId&&e.highlightedRouteId!==t&&r(e,e.highlightedRouteId),e.blinkingTimers[t]&&(clearInterval(e.blinkingTimers[t]),delete e.blinkingTimers[t],r(e,t));const i=e.routeLayers[t];if(i){const t=e.highlightedColor,a={type:"simple",title:"路径",symbol:{type:"simple-line",color:t,width:5}};i.renderer=a}e.highlightedRouteId=t,o(e,t)}function o(e,t){const i=e.routeLayers[t];if(!i)return;let a=!1;const s=t===e.noGlareRouteId?e.noGlareColor:e.defaultColor,l=setInterval((()=>{a=!a;const t=a?e.highlightedColor:e.highlightedBlinkColor,s={type:"simple",title:"路径",symbol:{type:"simple-line",color:t,width:4.5}};i.renderer=s}),300);e.blinkingTimers[t]=l,setTimeout((()=>{clearInterval(e.blinkingTimers[t]),delete e.blinkingTimers[t];const a={type:"simple",title:"路径",symbol:{type:"simple-line",color:e.highlightedColor,width:4.5}};i.renderer=a,setTimeout((()=>{r(e,t,s)}),3e3)}),3e3)}function r(e,t,i=null){e.blinkingTimers[t]&&(clearInterval(e.blinkingTimers[t]),delete e.blinkingTimers[t]);const a=e.routeLayers[t];if(a){const i=t===e.noGlareRouteId,s=i?e.defaultColor:e.noGlareColor,l={type:"simple",title:"路径",symbol:{type:"simple-line",color:s,width:i?4.5:3}};a.renderer=l}}function d(e,t,i=!0){const a={name:t.name,address:t.address,wgs84_latitude:t.wgs84_latitude,wgs84_longitude:t.wgs84_longitude,location:[t.wgs84_longitude,t.wgs84_latitude],baidu_index:t.baidu_index,baidu_latitude:t.baidu_latitude,baidu_longitude:t.baidu_longitude,id:t.id,label:t.label};let s=e.selectedResultStart?JSON.stringify(e.selectedResultStart):null,l=e.selectedResultEnd?JSON.stringify(e.selectedResultEnd):null;i?(e.selectedResultStart=a,e.searchQueryStart=a.name,e.searchResults=[],s=JSON.stringify(a)):(e.selectedResultEnd=a,e.searchQueryEnd=a.name,e.searchResultsEnd=[],l=JSON.stringify(a)),e.$router.push({path:"/lu-jing-gui-hua/Intermediate-page",query:{start:s,end:l,date:e.selectedDate,time:e.selectedTime,BasemapLayer:e.BasemapName}})}function u(e){e.isSwapping=!0;const t=e.searchQueryStart;e.searchQueryStart=e.searchQueryEnd,e.searchQueryEnd=t;const i=e.selectedResultStart;e.selectedResultStart=e.selectedResultEnd,e.selectedResultEnd=i,e.onSearch().then((()=>{a(e),e.initMap(),e.searchQueryStart=e.selectedResultStart.name,e.searchQueryEnd=e.selectedResultEnd.name,e.isSwapping=!1})).catch((()=>{e.isSwapping=!1}))}},55145:function(e,t,i){i.r(t),i.d(t,{default:function(){return ie}});var a=i(56768),s=i(45130),l=i(24232),n=i(34739),o=i(1592),r=i(9239),d=i(74963);const u={class:"lu-jing-gui-hua"},h={class:"search-containers"},c={class:"revert-containers"},m={class:"swap-action"},g=["src"],p={class:"search-container start"},A={class:"search-box-img"},f={key:0,class:"search-results",ref:"searchResultsStart"},y=["onClick"],w={class:"search-container end"},b={class:"search-box-img"},R={key:0,class:"search-results",ref:"searchResultsEnd"},k=["onClick"],v=["src"],L={key:0,class:"loader-overlay"},S={key:0,class:"maploader-overlay"},E={class:"main-container"},C={class:"choose-time"},D={class:"form-group"},x=["min","max"],B={class:"routelist"},Q={class:"cardlist"},I={class:"intro"},T={class:"intro"},z={class:"intro"},J={class:"intro"};function V(e,t,V,q,N,G){return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",u,[(0,a.Lk)("div",h,[(0,a.Lk)("div",c,[t[16]||(t[16]=(0,a.Lk)("div",{class:"car"},[(0,a.Lk)("img",{src:n})],-1)),(0,a.Lk)("div",m,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>G.swap&&G.swap(...e)),title:"切换起终点"},[(0,a.Lk)("img",{src:i(23497),alt:"",class:"revert"},null,8,g)])])]),(0,a.Lk)("div",p,[t[18]||(t[18]=(0,a.Lk)("div",{class:"search-icon-wrapper"},[(0,a.Lk)("img",{src:o,alt:"pink"})],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>N.searchQueryStart=e),onInput:t[2]||(t[2]=e=>G.onSearchInputChange(e,!0)),placeholder:"请输入起点",class:"search-box search-box-start"},null,544),[[s.Jo,N.searchQueryStart]]),(0,a.Lk)("span",A,[(0,a.Lk)("div",{class:"delete",title:"清空",onClick:t[3]||(t[3]=(...e)=>G.clc1&&G.clc1(...e))},t[17]||(t[17]=[(0,a.Lk)("img",{src:r,alt:"delete1"},null,-1)]))]),N.searchResults.length&&N.searchQueryStart?((0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(N.searchResults,((e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:t,class:(0,l.C4)({highlighted:t===N.highlightedIndex}),onClick:t=>G.selectResult(e,!0)},(0,l.v_)(e.name),11,y)))),128))])],512)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",w,[t[20]||(t[20]=(0,a.Lk)("div",{class:"search-icon-wrapper"},[(0,a.Lk)("img",{src:d,alt:"green"})],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>N.searchQueryEnd=e),onInput:t[5]||(t[5]=e=>G.onSearchInputChange(e,!1)),placeholder:"请输入终点",class:"search-box search-box-end"},null,544),[[s.Jo,N.searchQueryEnd]]),(0,a.Lk)("span",b,[(0,a.Lk)("div",{class:"delete",title:"清空",onClick:t[6]||(t[6]=(...e)=>G.clc2&&G.clc2(...e))},t[19]||(t[19]=[(0,a.Lk)("img",{src:r,alt:"delete1"},null,-1)]))]),N.searchResultsEnd.length&&N.searchQueryEnd?((0,a.uX)(),(0,a.CE)("div",R,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(N.searchResultsEnd,((e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:t,class:(0,l.C4)({highlighted:t===N.highlightedIndex}),onClick:t=>G.selectResult(e,!1)},(0,l.v_)(e.name),11,k)))),128))])],512)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",{class:"search-action",onClick:t[7]||(t[7]=(...e)=>G.onSearch&&G.onSearch(...e)),title:"搜索"},[(0,a.Lk)("img",{src:i(8105),alt:"",class:"search"},null,8,v)]),N.isLoading?((0,a.uX)(),(0,a.CE)("div",L,t[21]||(t[21]=[(0,a.Lk)("div",{class:"loader"},null,-1)]))):(0,a.Q3)("",!0)])]),t[28]||(t[28]=(0,a.Lk)("div",{id:"viewDiv"},null,-1)),N.ismaploading?((0,a.uX)(),(0,a.CE)("div",S,t[22]||(t[22]=[(0,a.Lk)("div",{class:"maploader"},null,-1)]))):(0,a.Q3)("",!0),(0,a.Lk)("div",E,[(0,a.Lk)("div",C,[(0,a.Lk)("div",D,[t[23]||(t[23]=(0,a.Lk)("label",{for:"date-input"},"选择日期：",-1)),(0,a.bo)((0,a.Lk)("input",{id:"date-input",type:"date","onUpdate:modelValue":t[8]||(t[8]=e=>N.selectedDate=e),min:G.minDate,max:G.maxDate,class:(0,l.C4)({"invalid-date":G.isDateDisabled(N.selectedDate)}),onChange:t[9]||(t[9]=(...e)=>G.handleDateChange&&G.handleDateChange(...e))},null,42,x),[[s.Jo,N.selectedDate]]),t[24]||(t[24]=(0,a.Lk)("label",{for:"time-input"},"选择时间：",-1)),(0,a.bo)((0,a.Lk)("input",{id:"time-input",type:"time","onUpdate:modelValue":t[10]||(t[10]=e=>G.formattedTime=e),onInput:t[11]||(t[11]=(...e)=>G.onTimeInputChange&&G.onTimeInputChange(...e)),step:"600"},null,544),[[s.Jo,G.formattedTime]])])]),(0,a.Lk)("div",null,[(0,a.bF)(s.eB,{name:"fade"},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.Lk)("div",B,[(0,a.Lk)("ul",Q,[(0,a.Lk)("div",{class:"route","data-index":"1",onClick:t[12]||(t[12]=e=>G.highlightRoute("noGlareRouteId"))},[(0,a.Lk)("div",{class:"introduction",style:(0,l.Tr)({color:G.getColor(1)})},"无眩光路径",4),(0,a.Lk)("p",I,[(0,a.Lk)("span",null,"用时："+(0,l.v_)(N.totalHours)+"小时"+(0,l.v_)(N.totalMinutes)+"分钟",1),t[25]||(t[25]=(0,a.eW)(" | ")),(0,a.Lk)("span",null,"路长："+(0,l.v_)(N.totalDistance),1)]),(0,a.Lk)("p",T,[(0,a.Lk)("span",null,"途径："+(0,l.v_)(N.totalPass),1)])]),(0,a.Lk)("div",{class:"route","data-index":"0",onClick:t[13]||(t[13]=e=>G.highlightRoute("defaultRouteId"))},[(0,a.Lk)("div",{class:"introduction",style:(0,l.Tr)({color:G.getColor(0)})},"常规路径",4),(0,a.Lk)("p",z,[(0,a.Lk)("span",null,"用时："+(0,l.v_)(N.noGlareTotalHours)+"小时"+(0,l.v_)(N.noGlareTotalMinutes)+"分钟",1),t[26]||(t[26]=(0,a.eW)(" | ")),(0,a.Lk)("span",null,"路长："+(0,l.v_)(N.noGlareTotalDistance),1)]),(0,a.Lk)("p",J,[(0,a.Lk)("span",null,"途径："+(0,l.v_)(N.noGlareTotalPass),1)])])]),(0,a.Lk)("span",{class:"toggle-button",onClick:t[14]||(t[14]=(...e)=>G.toggleRouteList&&G.toggleRouteList(...e)),title:"隐藏"},t[27]||(t[27]=[(0,a.Lk)("img",{src:r,alt:"delete1"},null,-1)]))],512),[[s.aG,N.isRouteListVisible]])])),_:1}),N.isRouteListVisible?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[15]||(t[15]=(...e)=>G.toggleRouteList&&G.toggleRouteList(...e)),class:"open-button"},"展开路线结果"))])])],64)}i(44114),i(14603),i(47566),i(98721);var q=i(3903),N=i(43487),G=i(11134),M=i(74036),U=i(58423),Z=i(3949),P=i(41759),F=i(94373),O=i(90144),H=i(57829),Y=i(95587),K=i(87923),W=i(44432),j=i(50346),X=i(73241),_=i(51197),$={name:"RouteView",data(){return{searchQueryStart:"",searchQueryEnd:"",selectedResultStart:null,selectedResultEnd:null,searchResults:[],searchResultsEnd:[],isLoading:!1,ismaploading:!1,totalHours:0,totalMinutes:0,totalDistance:"0千米",selectedDate:"",selectedTime:"",noGlareTotalHours:0,noGlareTotalMinutes:0,highlightedIndex:-1,noGlareTotalDistance:"0千米",highlightedRouteId:null,routeLayers:{},blinkingTimers:{},highlightedColor:[0,123,255,1],highlightedBlinkColor:[0,123,255,.2],noGlareColor:[244,96,108],defaultColor:[25,202,173],noGlareRouteId:"noGlareRouteId",defaultRouteId:"defaultRouteId",isRouteListVisible:!0,totalPass:"",noGlareTotalPass:"",BasemapName:null}},mounted(){this.created(),this.initMap(),this.$route.query.start&&this.$route.query.end&&(this.selectedResultStart=JSON.parse(this.$route.query.start),this.selectedResultEnd=JSON.parse(this.$route.query.end)),(0,X.Dk)(this),window.addEventListener("keydown",this.handleKeydown)},beforeUnmount(){window.removeEventListener("keydown",this.handleKeydown)},computed:{minDate(){return"2024-01-01"},maxDate(){return"2024-12-31"},formattedTime(){if(!this.selectedTime)return"";const[e,t]=this.selectedTime.split(":").map(Number),i=10*Math.floor(t/10);return`${String(e).padStart(2,"0")}:${String(i).padStart(2,"0")}`}},methods:{toggleRouteList(){(0,X.U)(this)},getColor(e){return(0,X.oU)(e)},highlightRoute(e){(0,X.uG)(this,e)},onTimeInputChange(e){(0,_.Lk)(this,e)},isDateDisabled(e){return(0,_.zJ)(this,e)},handleDateChange(e){(0,_.d5)(this,e)},handleKeydown(e){(0,_.y9)(this,e)},updateTime(){(0,_.JA)(this)},clc1(){(0,_.YK)(this)},clc2(){(0,_.dn)(this)},swap(){(0,X.wg)(this)},onSearchInputChange(e,t){(0,_.eE)(this,e,t)},selectResult(e,t=!0){(0,X.wf)(this,e,t)},onSearch(){return new Promise(((e,t)=>{if(this.selectedResultStart&&this.selectedResultEnd){this.isLoading=!0;const i={...this.selectedResultStart,location:[this.selectedResultStart.wgs84_longitude,this.selectedResultStart.wgs84_latitude]},a={...this.selectedResultEnd,location:[this.selectedResultEnd.wgs84_longitude,this.selectedResultEnd.wgs84_latitude]},s=5===this.selectedTime.length?`${this.selectedTime}:00`:this.selectedTime;F.A.post("https://dce4-2001-da8-2019-b282-14c-86be-f57b-b795.ngrok-free.app/api/route/plan",{start:i,end:a,date:this.selectedDate,time:s}).then((t=>{const l=t.data.default_id,n=t.data.time_based_id;this.isLoading=!1,this.$router.push({path:"/lu-jing-gui-hua/route",query:{start:JSON.stringify(i),end:JSON.stringify(a),default_id:l,time_based_id:n,date:this.selectedDate,time:s,BasemapLayer:this.BasemapName}}),this.searchQueryStart=i.name,this.searchQueryEnd=a.name,e()})).catch((e=>{console.error(e),this.isLoading=!1,alert("路径规划失败，请稍后再试。"),t(e)}))}else alert("请确保起点和终点都已选择。"),t(new Error("请确保起点和终点都已选择。"))}))},initMap(e){const t=new q.A({basemap:e||this.BasemapName||"tianditu-vector"});this.map=t,this.view=new N.A({container:"viewDiv",map:t,center:[114.3,30.7],zoom:4,constraints:{geometry:{type:"extent",xmin:113.6,ymin:29.9,xmax:115,ymax:31.3},minScale:500,maxScale:2e6,rotationEnabled:!1,snapToZoom:!1}});const i=new H.A({view:this.view,source:{query:{title:'"Basemaps for Developers" AND owner:geoscenedev'}}});i.watch("activeBasemap",(e=>{this.handleBasemapChange(e)}));const a=new Y.A({view:this.view}),s=new K.A({view:this.view,unit:"metric",style:"ruler"}),l=new W.A({view:this.view,unit:"metric",unitOptions:{metric:["kilometers","meters"],nonMetric:["miles","feet"]},iconClass:"esri-icon-measure-line"}),n=new j.A({view:this.view});this.view.ui.add(l,{position:"bottom-leading",index:0}),this.view.ui.add(i,{position:"bottom-right",index:0}),this.view.ui.add(n,{position:"bottom-right",index:1}),this.view.ui.move("zoom",{position:"bottom-left",index:1}),this.view.ui.add(a,{position:"bottom-left",index:2}),this.view.ui.add(s,{position:"bottom-left",index:3});const o=new U.A({title:"起点与终点"});t.add(o);const r=new Z["default"]({url:"https://www.geosceneonline.cn/server/rest/services/Hosted/wuhan_village/FeatureServer",title:"武汉县区面",renderer:{type:"simple",title:"县区边界",symbol:{type:"simple-fill",color:[0,0,0,0],outline:{color:[0,0,0,1],width:1}}},popupTemplate:{content:[{type:"fields",fieldInfos:[{fieldName:"县区name",label:"县区名称"}]}]}});t.add(r),t.add(o),this.view.when((()=>{this.drawPoints(o),this.adjustView(),this.drawRoutes(t)})).catch((e=>{console.error("MapView initialization error:",e)}))},handleBasemapChange(e){const t={"天地图-矢量（球面墨卡托投影）":"tianditu-vector","天地图-影像（球面墨卡托投影）":"tianditu-image","天地图-地形（球面墨卡托投影）":"tianditu-topography"};t[e.title]?this.BasemapName=t[e.title]:this.BasemapName=e.title;const i=new URLSearchParams(window.location.search);i.set("BasemapLayer",this.BasemapName),window.history.replaceState({},"",`${window.location.pathname}?${i}`)},created(){const e=this.$route.query.BasemapLayer,t={"天地图-矢量（球面墨卡托投影）":"tianditu-vector","天地图-影像（球面墨卡托投影）":"tianditu-image","天地图-地形（球面墨卡托投影）":"tianditu-topography","天地图-矢量（含注记）（球面墨卡托投影）":"tianditu-vector"};e&&(t[e]?this.BasemapName=t[e]:this.BasemapName=e)},adjustView(){if(this.selectedResultStart&&this.selectedResultEnd){const e=.01,t=new P.A({xmin:Math.min(this.selectedResultStart.location[0],this.selectedResultEnd.location[0])-10*e,ymin:Math.min(this.selectedResultStart.location[1],this.selectedResultEnd.location[1])-10*e,xmax:Math.max(this.selectedResultStart.location[0],this.selectedResultEnd.location[0])+10*e,ymax:Math.max(this.selectedResultStart.location[1],this.selectedResultEnd.location[1])+10*e});this.view.goTo(t).catch((e=>{console.error("Error adjusting view:",e)}))}else this.selectedResultStart?this.view.goTo({center:[this.selectedResultStart.location[0],this.selectedResultStart.location[1]],zoom:10}).catch((e=>{console.error("Error adjusting view:",e)})):this.selectedResultEnd&&this.view.goTo({center:[this.selectedResultEnd.location[0],this.selectedResultEnd.location[1]],zoom:10}).catch((e=>{console.error("Error adjusting view:",e)}))},drawPoints(e){if(!this.$route.query.start||!this.$route.query.end)return void console.error("Start or end point is undefined.");const t=JSON.parse(this.$route.query.start),i=JSON.parse(this.$route.query.end);if(!t.location||!i.location)return void console.error("Start or end point does not have a location.");const a=new M.A({longitude:t.location[0],latitude:t.location[1]}),s=new M.A({longitude:i.location[0],latitude:i.location[1]}),l=new G.A({geometry:a,title:"起点",symbol:{type:"simple-marker",color:"red",size:"20px"},popupTemplate:{title:"起点信息",content:[{type:"fields",fieldInfos:[{fieldName:"address",label:"地址"},{fieldName:"name",label:"名称"},{fieldName:"wgs84_latitude",label:"WGS84纬度"},{fieldName:"wgs84_longitude",label:"WGS84经度"},{fieldName:"baidu_index",label:"百度索引"},{fieldName:"baidu_latitude",label:"百度纬度"},{fieldName:"baidu_longitude",label:"百度经度"},{fieldName:"id",label:"ID"},{fieldName:"label",label:"标签"}]}]},attributes:t}),n=new G.A({geometry:s,title:"终点",symbol:{type:"simple-marker",color:"green",size:"20px"},popupTemplate:{title:"终点信息",content:[{type:"fields",fieldInfos:[{fieldName:"address",label:"地址"},{fieldName:"name",label:"名称"},{fieldName:"wgs84_latitude",label:"WGS84纬度"},{fieldName:"wgs84_longitude",label:"WGS84经度"},{fieldName:"baidu_index",label:"百度索引"},{fieldName:"baidu_latitude",label:"百度纬度"},{fieldName:"baidu_longitude",label:"百度经度"},{fieldName:"id",label:"ID"},{fieldName:"label",label:"标签"}]}]},attributes:i});e.addMany([l,n])},drawRoutes(e){const t=this.$route.query.default_id,i=this.$route.query.time_based_id;t||i?(t&&this.fetchAndDrawRoute(e,t,[25,202,173],!0),i&&this.fetchAndDrawRoute(e,i,[244,96,108])):console.error("Route IDs are undefined.")},fetchAndDrawRoute(e,t,i,a=!1){const s=`https://dce4-2001-da8-2019-b282-14c-86be-f57b-b795.ngrok-free.app/api/get_geojson/${t}`;fetch(s).then((e=>e.json())).then((t=>{let s=0,l=0;const n={},o=t.features.map(((e,t)=>(99999!==e.properties.cost&&(s+=e.properties.length,l+=e.properties.cost),e.properties.name.includes("未知")||(n[e.properties.name]||(n[e.properties.name]={length:0,order:t}),n[e.properties.name].length+=e.properties.length),{geometry:{type:"polyline",paths:e.geometry.coordinates},attributes:{...e.properties,id:t,routeType:a?"耗时少路径":"无眩光路径"}}))),r=Object.entries(n).sort(((e,t)=>t[1].length-e[1].length||e[1].order-t[1].order)),d=r.slice(0,3).map((e=>e[0])).join("->"),u=new Z["default"]({title:a?"耗时少路径":"无眩光路径",source:o,renderer:{type:"simple",title:a?"耗时少路径":"无眩光路径",symbol:{type:"simple-line",color:i,width:a?4.5:3}},objectIdField:"id",fields:[{name:"id",type:"oid"},{name:"seq",type:"integer"},{name:"path_seq",type:"integer"},{name:"node",type:"integer"},{name:"edge",type:"integer"},{name:"cost",type:"double"},{name:"agg_cost",type:"double"},{name:"length",type:"double"},{name:"name",type:"string"},{name:"maxspeed",type:"integer"},{name:"routeType",type:"string"}],popupTemplate:{title:"{routeType} - {name}",content:[{type:"text",text:`总距离: ${(s/1e3).toFixed(2)} km<br>总耗时: ${(l/3600).toFixed(2)} 小时`},{type:"fields",fieldInfos:[{fieldName:"length",label:"长度（米）"},{fieldName:"cost",label:"耗时（秒）"},{fieldName:"maxspeed",label:"最大速度"},{fieldName:"name",label:"名称"}]}]}}),h=(0,O.IG)(u);e.layers.add(h),l<3600&&(l+=60);const c=Math.floor(l/3600),m=Math.floor(l%3600/60);let g;g=s<1e3?`${s.toFixed(2)}米`:`${(s/1e3).toFixed(2)}千米`,a?(this.noGlareTotalHours=c,this.noGlareTotalMinutes=m,this.noGlareTotalDistance=g,this.noGlareTotalPass=d,this.routeLayers.noGlareRouteId=u):(this.totalHours=c,this.totalMinutes=m,this.totalDistance=g,this.totalPass=d,this.routeLayers.defaultRouteId=u)})).catch((e=>console.error("Error loading the geojson file:",e)))}}},ee=i(71241);const te=(0,ee.A)($,[["render",V]]);var ie=te},9239:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAt1BMVEUAAAD///+qqqqAgICZmZmVlZWenp6Xl5eZmZmbm5uenp6ZmZmcnJyYmJiampqZmZmbm5uYmJiampqbm5uZmZmampqYmJiampqbm5uZmZmampqZmZmampqbm5ubm5uampqampqZmZmampqZmZmampqbm5uampqZmZmampqampqampqampqbm5uampqampqampqZmZmampqampqZmZmampqampqampqampqampqampqampqampqampqw7qK0AAAAPHRSTlMAAQMEBQwVFhkhIiMkJSYtLi8wRUZHSElKS3x9fn+Wl5iZmp6foKGjpLS1tre4wtLT1tfY2dvt7u/6+/wzxdzZAAAAAWJLR0QB/wIt3gAAAOdJREFUGNNVkF1XglAQRTcS3DSQlEoyv0rTtLKbGsLl/P/f1QPqwnmbvdZZc2ZDPX4/y3o+zekuC0k6LuIL8sZO2q03e8m9eCf2ITdpA3SmTquajlWk51BaaATQdS4lCAHCgLRyMbDUhGBrDRi7DZhpATeF2oRW1hgrG3Kn3KevX8BYWStrgL3uedaamtaMLz0x0AYg/JF2twDfeqSn3XX8oAT/qE7zUKS8Be+aNiu9ag7EZZU1yrsyAhg13nwoNKyFrORmHYDorToLwRs56bD5/JPKoXcxGi9yScrn0ZV7P8kGSeu0/AOgQSGjf0LSLgAAAABJRU5ErkJggg=="},34739:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVR4nO2TQWoCQRBFWzcGNEcQhCQbFyZMZ+UmV0ju4iYqDDpVhJBVTuIlXMaFNzEEQrLQF3poVzrTLYMgwYJaNPxf//+ubmPOdZJllWkifFuFmM6xwiRq+H1G2wqb2OF228Lm9oVOUCDJGHjCzEAtSICaw+ZJMgYx17Pwrh6jIjtTwpM39VE+POMqd6J8PqRcxApcv9Owwspx76bclLkf+6XNTUo9VsBhHccnHxcLCMuDl6s7y16WJVhXFlDWZQLbd/3ce6OZKMOIP7CDDQp0U1ru3H/lMiSwDxtOoAwd0QqjYII92KBA1Tb/WuDXv+WfQlAVrhXUKl+JIoWgI3DPZY5af/ThJlHmC57YAAAAAElFTkSuQmCC"},74963:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAABRUlEQVQokaWRTU4CQRCFv2qQlTvQ4F4lRG+gmHgHI3oBDBBJPABMg0cQ8Ap6DSGu3Jrgz1qIuGDhSp1uF8yMHZwIiW9Xr+rret0N/5DMGvpR7xljKkAByABjoK9EtXVO92Ph0l1pKbucvQBO/lh2qYaqpvf1F0AydBcAAcp2zVqgCqDCqC4oVq5UQm2N3kcp69tt4DrsWWxFP+jdaHNwxwhs5pvHzrZ74MgbeGKxhwAGUwH6KhgoRHBSzuPyGt+0osJO50M4EzU+eI6DJ6mJ66+48Ftkp1iPg9Of6Q2nHLtwz4nX+EVaxFe+F5aC3EDwYFZsR6wUg17RG3hifNNKkHhC2PQffE+Qgwi20pkeEqgxaHSBclxkVyLSbuaap25s1FDVBOnOA+VFzn7iz6g+qO+ISDX4jlXgFaGnjGrrvL6dl2xhfQOqgmx7UWxefQAAAABJRU5ErkJggg=="},1592:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAABLElEQVQokaWS0U0CURBFz7xV/gG1AvVHO8C1CmO0AgNk2diAEOxgWTB0oJYBhA780goEtgHMjh9LllHWQOL8zX3vZO59b+AfJb8FjeNLVBuADxwAM2CCc7E0m5NCWIfDfZbLHqp3f45SfSJJWtLpfAHs5QfbQACROtWqAk0AZ6xa8BnVM0qlEiLnwIs5a2i/f7GenGXMQQmCW9O/ATcaRYLINQBp2gAmbnXBN7keCy071zWdn9sme9WskuSjEE5Tqx9aeJ7LlcpxIax6YrqZhce5LPKwyangeW0jjWD1zxpFPiIjc/sV57rM5++Uy6d4XhvVKxOhJmE4XS9JFA0QqRda/lmxBEFgbUOStIDBNpDF4j5PuJGv16uRbZAPHAGfwJg0jSUMpzs4262+ARvYazC3hlvBAAAAAElFTkSuQmCC"},23497:function(e){e.exports="data:image/png;base64,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"},8105:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABAlBMVEUAAAAA//8AgP9Vqv9AgP9AgP85gP82hv8zgP8xhv8ugP8xif83if81hP81h/80g/8zhf8yh/80hP8yhP80hv8xhP81hv81g/80hf8yhP80hv80hv8yhP8yhP8yhf8yhv80hf8yhf8zhP8zhv8zhP8yhf8yhf8zhv8zhf8yhv80hf8zhv80hf8zhv8yhf80hf8zhf80hf8zhv8zhf8zhv80hP8zhf8yhf80hf8zhP8zhf8zhv8yhf80hf8zhf8zhf8zhf8zhP8zhf8zhf8zhf8zhf8zhf8zhf8zhf8zhf8zhf8zhf8zhf8zhf8zhf8zhf8zhf8zhv8zhf8zhf8zhf////8f5maRAAAAVHRSTlMAAQIDBAgSExQVFhocHSInMjM2ODs+P0RFTU5UV1tcYWJmaGlqa3V4eXp7fIqNjpSVo6SlpqapsbK5ur/AwcLDz9Da3t/g4uPo7/Lz9PX2+/z8/f6zDptbAAAAAWJLR0RVkwS4MwAAARJJREFUGBm9wek6AmEAhuE3k11FdjOmkH3LTihblO0b9Zz/sZh0Vd9Efrnct/5TLL25f7S3NKafOZkyX+qFCf1g8JK2+nZM3YbusOXVxbki9Ha4urhepCGnqAyhi1E1zFWA5xHZ+spAIa6mVBXYkW0SeB9TSw54kG0DOFRb/wuQlCUP5NRxDczIcgD46jgH5mXZBdbVcQukZVkGSmpL1CAYlCVRB2bVcgSUFFEAKik1rRHKKmK8BlRX+iUlTgg9OYraouG1eHZToyHwFBXLE2U8dVl5puXxAwh8dRneuScUlLKOa4DA1zfJ6YX0gEKuAQJfvbkGCHz15hnAeOrNM4CZUm+ugdO4fuGZY0e/mnL0Jz4BcBxPYxuSuGYAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=lu-jing-gui-hua-routesw.18a6b57c.js.map