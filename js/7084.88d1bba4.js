"use strict";(self["webpackChunksun_glare_project"]=self["webpackChunksun_glare_project"]||[]).push([[7084,8531],{66140:function(e,t,r){r.d(t,{lY:function(){return c},mT:function(){return d}});var s,n=r(28531),i=r(14116);class o{}o.instance=new i.oh("Etc/UTC"),function(e){e.TimeZoneNotRecognised="TimeZoneNotRecognised"}(s||(s={}));const a={[s.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};class u extends Error{constructor(e,t){super((0,n.A2)(a[e],t)),this.declaredRootClass="geoscene.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,u)}}class c{constructor(e){this._date=e,this.declaredRootClass="geoscene.arcade.arcadedate"}static fromParts(e=0,t=1,r=1,s=0,n=0,o=0,a=0,u){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(s)||isNaN(n)||isNaN(o)||isNaN(a))return null;let l=0;const h=i.c9.local(e,t).daysInMonth;r<1&&(l=r-1,r=1),r>h&&(l=r-h,r=h);let f=0;t>12?(f=t-12,t=12):t<1&&(f=t-1,t=1);let m=0;n>59?(m=n-59,n=59):n<0&&(m=n,n=0);let p=0;o>59?(p=o-59,o=59):o<0&&(p=o,o=0);let _=0;a>999?(_=a-999,a=999):a<0&&(_=a,a=0);let g=i.c9.fromObject({day:r,year:e,month:t,hour:s,minute:n,second:o,millisecond:a},{zone:d(u)});return 0!==f&&(g=g.plus({months:f})),0!==l&&(g=g.plus({days:l})),0!==m&&(g=g.plus({minutes:m})),0!==p&&(g=g.plus({seconds:p})),0!==_&&(g=g.plus({milliseconds:_})),new c(g)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,t){const r=d(t);return e.isUnknownTimeZone||r===o.instance?c.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,r):new c(e._date.setZone(t))}static dateJSToArcadeDate(e){return new c(i.c9.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,t="system"){return new c(i.c9.fromJSDate(e,{zone:t}))}static unknownEpochToArcadeDate(e){return new c(i.c9.fromMillis(e,{zone:o.instance}))}static unknownDateJSToArcadeDate(e){return new c(i.c9.fromMillis(e.getTime(),{zone:o.instance}))}static epochToArcadeDate(e,t="system"){return new c(i.c9.fromMillis(e,{zone:t}))}static dateTimeToArcadeDate(e){return new c(e)}clone(){return new c(this._date)}changeTimeZone(e){const t=d(e);return c.dateTimeToArcadeDate(this._date.setZone(t))}static dateTimeAndZoneToArcadeDate(e,t){const r=d(t);return e.zone===o.instance||r===o.instance?c.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,r):new c(e.setZone(r))}static nowToArcadeDate(e){return new c(i.c9.fromJSDate(new Date,{zone:e}))}static nowUTCToArcadeDate(){return new c(i.c9.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===c.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===o.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const e=this.zone;return"fixed"===e.type?0===e.fixed?"utc":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new c(this._date.plus(e))}diff(e,t="milliseconds"){return this._date.diff(e._date,t)[t]}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toFormat(e,t){return this._date.toFormat(e,t)}toJSDate(){return this._date.toJSDate()}toSQLString(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new c(this._date.toUTC())}toLocal(){return new c(this._date.toLocal())}toString(){return this.toISOString(!0)}}function d(e){if(e instanceof i.bo)return e;if("system"===e.toLowerCase())return"system";if("utc"===e.toLowerCase())return"utc";if("unknown"===e.toLowerCase())return o.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(e)){const t=i.mQ.parseSpecifier("UTC"+(e.startsWith("+")||e.startsWith("-")?"":"+")+e);if(t)return t}const t=i.oh.create(e);if(!t.isValid)throw new u(s.TimeZoneNotRecognised);return t}},75417:function(e,t,r){r.d(t,{vN:function(){return o}});r(66140);var s=r(27678),n=(r(41380),r(14116),r(10463));function i(e){return e?.timeZoneIANA?e?.timeZoneIANA:e?.timeZone?(0,n.S)(e,""):""}class o{constructor(){this.dateTimeReferenceMetaData=null,this._fieldTimeZoneIndex={},this._fieldIndex=null,this._ianaPreferred=null,this._ianaTimeInfo=null,this._ianaEditFields=null,this._ianaLayerDateFields=null}static create(e,t){const r=new o;return r.dateTimeReferenceMetaData=t,r._fieldIndex=e instanceof s.A?e:new s.A(e),r}static createFromLayer(e){if(!e)return null;if(!e.fieldsIndex)return!e.declaredClass&&e.fields?o.create(e.fields,e):null;const t=new o;return t._fieldIndex=e.fieldsIndex,t.dateTimeReferenceMetaData={timeInfo:e?.timeInfo?.toJSON()??null,editFieldsInfo:e?.editFieldsInfo?.toJSON()??null,dateFieldsTimeReference:e?.dateFieldsTimeReference?.toJSON()??null,preferredTimeReference:e?.preferredTimeReference?.toJSON()??null,datesInUnknownTimezone:!0===e?.datesInUnknownTimezone},t}fieldTimeZone(e){const t=this._fieldIndex?.get(e);if(!t)return null;if("date"!==t.type&&"esriFieldTypeDate"!==t.type)return null;const r=this._fieldTimeZoneIndex[t.name];if(void 0!==r)return r;const s=[{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.creationDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.editDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.startTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.endTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone}];for(const i of s)if(i.field===t.name){const e=this.convertToIANA(i.timeReference,i.isunknown);return this._fieldTimeZoneIndex[t.name]=e,e}const n=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone);return this._fieldTimeZoneIndex[t.name]=n,n}convertToIANA(e,t){return t?"unknown":i(e)}get layerPreferredTimeZone(){if(null!==this._ianaPreferred)return this._ianaPreferred;this._ianaPreferred="";const e=this.dateTimeReferenceMetaData?.preferredTimeReference;return this._ianaPreferred=this.convertToIANA(e,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaPreferred}get layerTimeInfoTimeZone(){if(null!==this._ianaTimeInfo)return this._ianaTimeInfo;this._ianaTimeInfo="";const e=this.dateTimeReferenceMetaData?.timeInfo?.timeReference;return this._ianaTimeInfo=this.convertToIANA(e,!1),this._ianaTimeInfo}get layerEditFieldsTimeZone(){if(null!==this._ianaEditFields)return this._ianaEditFields;this._ianaEditFields="";const e=this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference;return this._ianaEditFields=this.convertToIANA(e,this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaEditFields}get layerDateFieldsTimeZone(){if(null!==this._ianaLayerDateFields)return this._ianaLayerDateFields;this._ianaLayerDateFields="";const e=this.dateTimeReferenceMetaData?.dateFieldsTimeReference;return this._ianaLayerDateFields=this.convertToIANA(e,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaLayerDateFields}}},28531:function(e,t,r){var s;r.d(t,{A2:function(){return l},B:function(){return f},D$:function(){return a},Nh:function(){return h},O$:function(){return d},TX:function(){return s},mT:function(){return c},ps:function(){return p}}),function(e){e.AsyncNotEnabled="AsyncNotEnabled",e.ModulesNotSupported="ModulesNotSupported",e.CircularModules="CircularModules",e.NeverReach="NeverReach",e.UnsupportedHashType="UnsupportedHashType",e.InvalidParameter="InvalidParameter",e.UnexpectedToken="UnexpectedToken",e.Unrecognised="Unrecognised",e.UnrecognisedType="UnrecognisedType",e.MaximumCallDepth="MaximumCallDepth",e.BooleanConditionRequired="BooleanConditionRequired",e.TypeNotAllowedInFeature="TypeNotAllowedInFeature",e.KeyMustBeString="KeyMustBeString",e.WrongNumberOfParameters="WrongNumberOfParameters",e.CallNonFunction="CallNonFunction",e.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral",e.NoFunctionInDictionary="NoFunctionInDictionary",e.NoFunctionInArray="NoFunctionInArray",e.AssignModuleFunction="AssignModuleFunction",e.LogicExpressionOrAnd="LogicExpressionOrAnd",e.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean",e.FunctionNotFound="FunctionNotFound",e.InvalidMemberAccessKey="InvalidMemberAccessKey",e.UnsupportedUnaryOperator="UnsupportUnaryOperator",e.InvalidIdentifier="InvalidIdentifier",e.MemberOfNull="MemberOfNull",e.UnsupportedOperator="UnsupportedOperator",e.Cancelled="Cancelled",e.ModuleAccessorMustBeString="ModuleAccessorMustBeString",e.ModuleExportNotFound="ModuleExportNotFound",e.Immutable="Immutable",e.OutOfBounds="OutOfBounds",e.IllegalResult="IllegalResult",e.FieldNotFound="FieldNotFound",e.PortalRequired="PortalRequired",e.LogicError="LogicError",e.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber",e.KeyAccessorMustBeString="KeyAccessorMustBeString",e.WrongSpatialReference="WrongSpatialReference"}(s||(s={}));const n={[s.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[s.LogicError]:"Logic error - {reason}",[s.NeverReach]:"Encountered unreachable logic",[s.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[s.ModuleAccessorMustBeString]:"Module accessor must be a string",[s.ModuleExportNotFound]:"Module has no export with provided identifier",[s.ModulesNotSupported]:"Current profile does not support modules",[s.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[s.FunctionNotFound]:"Function not found",[s.FieldNotFound]:"Key not found - {key}",[s.CircularModules]:"Circular module dependencies are not allowed",[s.Cancelled]:"Execution cancelled",[s.UnsupportedHashType]:"Type not supported in hash function",[s.IllegalResult]:"Value is not a supported return type",[s.PortalRequired]:"Portal is required",[s.InvalidParameter]:"Invalid parameter",[s.WrongNumberOfParameters]:"Call with wrong number of parameters",[s.Unrecognised]:"Unrecognised code structure",[s.UnrecognisedType]:"Unrecognised type",[s.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",[s.BooleanConditionRequired]:"Conditions must use booleans",[s.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[s.NoFunctionInArray]:"Arrays cannot contain functions.",[s.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[s.KeyAccessorMustBeString]:"Accessor must be a string",[s.KeyMustBeString]:"Object keys must be a string",[s.Immutable]:"Object is immutable",[s.UnexpectedToken]:"Unexpected token",[s.MemberOfNull]:"Cannot access property of null object",[s.MaximumCallDepth]:"Exceeded maximum function depth",[s.OutOfBounds]:"Out of bounds",[s.InvalidIdentifier]:"Identifier not recognised",[s.CallNonFunction]:"Expression is not a function",[s.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[s.AssignModuleFunction]:"Cannot assign function to module variable",[s.UnsupportedUnaryOperator]:"Unsupported unary operator",[s.UnsupportedOperator]:"Unsupported operator",[s.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[s.LogicExpressionOrAnd]:"Logical expression can only be combined with || or &&"};class i extends Error{constructor(...e){super(...e)}}class o extends i{constructor(e,t){super(u(t)+e.message,{cause:e}),this.loc=null,Error.captureStackTrace&&Error.captureStackTrace(this,o),t&&t.loc&&(this.loc=t.loc)}}class a extends Error{constructor(e,t,r,s){super("Execution error - "+u(r)+l(n[t],s)),this.loc=null,this.declaredRootClass="geoscene.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace(this,a),r&&r.loc&&(this.loc=r.loc)}}function u(e){return e&&e.loc?`Line : ${e.loc.start?.line}, ${e.loc.start?.column}: `:""}class c extends Error{constructor(e,t,r,s){super("Compilation error - "+u(r)+l(n[t],s)),this.loc=null,this.declaredRootClass="geoscene.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace(this,c),r&&r.loc&&(this.loc=r.loc)}}class d extends Error{constructor(){super("Uncompilable code structures"),this.declaredRootClass="geoscene.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace(this,d)}}function l(e,t){try{if(!t)return e;for(const r in t){let s=t[r];s||(s=""),e=e.replace("{"+r+"}",t[r])}}catch(i){}return e}function h(e,t,r){return"geoscene.arcade.arcadeexecutionerror"===r.declaredRootClass||"geoscene.arcade.arcadecompilationerror"===r.declaredRootClass?null===r.loc&&t&&t.loc?new o(r,{cause:r}):r:("geoscene.arcade.featureset.support.featureseterror"===r.declaredRootClass||"geoscene.arcade.featureset.support.sqlerror"===r.declaredRootClass||r.declaredRootClass,t&&t.loc?new o(r,{cause:r}):r)}var f;!function(e){e.UnrecognisedUri="UnrecognisedUri",e.UnsupportedUriProtocol="UnsupportedUriProtocol"}(f||(f={}));const m={[f.UnrecognisedUri]:"Unrecognised uri - {uri}",[f.UnsupportedUriProtocol]:"Unrecognised uri protocol"};class p extends Error{constructor(e,t){super(l(m[e],t)),this.declaredRootClass="geoscene.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace(this,p)}}},85508:function(e,t,r){r.d(t,{g:function(){return s}});const s={convertToGEGeometry:n,exportPoint:o,exportPolygon:u,exportPolyline:d,exportMultipoint:h,exportExtent:m};function n(e,t){return null==t?null:e.convertJSONToGeometry(t)}class i{constructor(e,t,r){this.x=e,this.y=t,this.spatialReference=r,this.z=void 0,this.m=void 0}}function o(e,t,r){const s=new i(e.getPointX(t),e.getPointY(t),r),n=e.hasZ(t),o=e.hasM(t);return n&&(s.z=e.getPointZ(t)),o&&(s.m=e.getPointM(t)),s}class a{constructor(e,t,r,s){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),s&&(this.hasM=s)}}function u(e,t,r){return new a(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))}class c{constructor(e,t,r,s){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),s&&(this.hasM=s)}}function d(e,t,r){return new c(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))}class l{constructor(e,t,r,s){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),s&&(this.hasM=s)}}function h(e,t,r){return new l(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))}class f{constructor(e,t,r,s,n){this.xmin=e,this.ymin=t,this.xmax=r,this.ymax=s,this.spatialReference=n,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}function m(e,t,r){const s=e.hasZ(t),n=e.hasM(t),i=new f(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(s){const r=e.getZExtent(t);i.zmin=r.vmin,i.zmax=r.vmax}if(n){const r=e.getMExtent(t);i.mmin=r.vmin,i.mmax=r.vmax}return i}},99939:function(e,t,r){r.d(t,{Q:function(){return n}});r(44114);function s(e,t){return e?t?4:3:t?3:2}function n(e,t,r,n,a){if(null==t||!t.lengths.length)return null;const u="upperLeft"===a?.originPosition?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const c=e.coords,d=[],l=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:h,coords:f}=t,m=s(r,n);let p=0;for(const s of h){const e=i(l,f,p,s,r,n,u);e&&d.push(e),p+=s*m}if(d.sort(((e,t)=>{let s=u*e[2]-u*t[2];return 0===s&&r&&(s=e[4]-t[4]),s})),d.length){let e=6*d[0][2];c[0]=d[0][0]/e,c[1]=d[0][1]/e,r&&(e=6*d[0][4],c[2]=0!==e?d[0][3]/e:0),(c[0]<l[0]||c[0]>l[1]||c[1]<l[2]||c[1]>l[3]||r&&(c[2]<l[4]||c[2]>l[5]))&&(c.length=0)}if(!c.length){const e=t.lengths[0]?o(f,0,h[0],r,n):null;if(!e)return null;c[0]=e[0],c[1]=e[1],r&&e.length>2&&(c[2]=e[2])}return e}function i(e,t,r,n,i,o,a=1){const u=s(i,o);let c=r,d=r+u,l=0,h=0,f=0,m=0,p=0;for(let s=0,g=n-1;s<g;s++,c+=u,d+=u){const r=t[c],s=t[c+1],n=t[c+2],o=t[d],a=t[d+1],u=t[d+2];let _=r*a-o*s;m+=_,l+=(r+o)*_,h+=(s+a)*_,i&&(_=r*u-o*n,f+=(n+u)*_,p+=_),r<e[0]&&(e[0]=r),r>e[1]&&(e[1]=r),s<e[2]&&(e[2]=s),s>e[3]&&(e[3]=s),i&&(n<e[4]&&(e[4]=n),n>e[5]&&(e[5]=n))}if(m*a>0&&(m*=-1),p*a>0&&(p*=-1),!m)return null;const _=[l,h,.5*m];return i&&(_[3]=f,_[4]=.5*p),_}function o(e,t,r,n,i){const o=s(n,i);let l=t,h=t+o,f=0,m=0,p=0,_=0;for(let s=0,g=r-1;s<g;s++,l+=o,h+=o){const t=e[l],r=e[l+1],s=e[l+2],i=e[h],o=e[h+1],g=e[h+2],y=n?u(t,r,s,i,o,g):a(t,r,i,o);if(y)if(f+=y,n){const e=d(t,r,s,i,o,g);m+=y*e[0],p+=y*e[1],_+=y*e[2]}else{const e=c(t,r,i,o);m+=y*e[0],p+=y*e[1]}}return f>0?n?[m/f,p/f,_/f]:[m/f,p/f]:r>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function a(e,t,r,s){const n=r-e,i=s-t;return Math.sqrt(n*n+i*i)}function u(e,t,r,s,n,i){const o=s-e,a=n-t,u=i-r;return Math.sqrt(o*o+a*a+u*u)}function c(e,t,r,s){return[e+.5*(r-e),t+.5*(s-t)]}function d(e,t,r,s,n,i){return[e+.5*(s-e),t+.5*(n-t),r+.5*(i-r)]}},33292:function(e,t,r){r.d(t,{Cv:function(){return p},Nk:function(){return h},lK:function(){return y}});r(44114);var s=r(69292),n=r(39582),i=r(85508),o=r(72465),a=r(30075);const u=[0,0];function c(e,t){if(!t)return null;if("x"in t){const r={x:0,y:0};return[r.x,r.y]=e(t.x,t.y,u),null!=t.z&&(r.z=t.z),null!=t.m&&(r.m=t.m),r}if("xmin"in t){const r={xmin:0,ymin:0,xmax:0,ymax:0};return[r.xmin,r.ymin]=e(t.xmin,t.ymin,u),[r.xmax,r.ymax]=e(t.xmax,t.ymax,u),t.hasZ&&(r.zmin=t.zmin,r.zmax=t.zmax,r.hasZ=!0),t.hasM&&(r.mmin=t.mmin,r.mmax=t.mmax,r.hasM=!0),r}return"rings"in t?{rings:d(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:d(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:l(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function d(e,t){const r=[];for(const s of e)r.push(l(s,t));return r}function l(e,t){const r=[];for(const s of e){const e=t(s[0],s[1],[0,0]);r.push(e),s.length>2&&e.push(s[2]),s.length>3&&e.push(s[3])}return r}async function h(e,t){if(!e||!t)return;const r=Array.isArray(e)?e.map((e=>null!=e.geometry?e.geometry.spatialReference:null)).filter(s.Ru):[e];await(0,n.initializeProjection)(r.map((e=>({source:e,dest:t}))))}const f=c.bind(null,a.je),m=c.bind(null,a.tD);function p(e,t,r,s){if(!e)return e;if(r||(r=t,t=e.spatialReference),!(0,o.fn)(t)||!(0,o.fn)(r)||(0,o.aI)(t,r))return e;if((0,a.y7)(t,r)){const t=(0,o.K8)(r)?f(e):m(e);return t.spatialReference=r,t}return(0,n.lK)(i.g,[e],t,r,null,s)[0]}class _{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,r){if(!e||!e.length||!t||!r||(0,o.aI)(t,r))return e;const s={geometries:e,inSpatialReference:t,outSpatialReference:r,resolve:null};return this._jobs.push(s),new Promise((e=>{s.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:r,outSpatialReference:s,resolve:u}=e;(0,a.y7)(r,s)?(0,o.K8)(s)?u(t.map(f)):u(t.map(m)):u((0,n.lK)(i.g,t,r,s,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}const g=new _;function y(e,t,r){return g.push(e,t,r)}},98520:function(e,t,r){r.d(t,{A:function(){return A}});r(16573),r(78100),r(77936),r(17642),r(58004),r(33853),r(45876),r(32475),r(15024),r(31698);var s=r(47966),n=r(51020),i=r(15114),o=r(26011),a=r(79908),u=r(71120),c=r(47161),d=r(42360),l=r(27678),h=r(17),f=r(54168),m=r(62830),p=r(37819),_=r(12974),g=r(73719);const y=i.A.getLogger("geoscene.views.layers.2d.features.support.AttributeStore"),I=(0,p.m)(p.X,y),T={sharedArrayBuffer:(0,n.A)("geoscene-shared-array-buffer"),atomics:(0,n.A)("geoscene-atomics")};function x(e,t){return r=>t(e(r))}class b{constructor(e,t,r,s){this.size=0,this.texelSize=4,this.dirtyStart=0,this.dirtyEnd=0;const{pixelType:n,layout:i,textureOnly:o}=s;this.textureOnly=o||!1,this.pixelType=n,this._ctype=t,this.layout=i,this._resetRange(),this._shared=e,this.size=r,o||(this.data=this._initData(n,r,e,t))}get buffer(){return(0,a.Rh)(this.data,(e=>e.buffer))}unsetComponentAllTexels(e,t){const r=this.data;for(let s=0;s<this.size*this.size;s++)r[s*this.texelSize+e]&=~t;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponentAllTexels(e,t){const r=this.data;for(let s=0;s<this.size*this.size;s++)r[s*this.texelSize+e]|=255&t;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponent(e,t,r){const s=this.data;for(const n of r)s[n*this.texelSize+e]|=t,this.dirtyStart=Math.min(this.dirtyStart,n),this.dirtyEnd=Math.max(this.dirtyEnd,n)}setComponentTexel(e,t,r){this.data[r*this.texelSize+e]|=t,this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,r)}unsetComponentTexel(e,t,r){this.data[r*this.texelSize+e]&=~t,this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,r)}getData(e,t){const r=(0,f.Q4)(e);return this.data[r*this.texelSize+t]}setData(e,t,r){const s=(0,f.Q4)(e),n=1<<t;0!=(this.layout&n)?null!=this.data&&(this.data[s*this.texelSize+t]=r,this.dirtyStart=Math.min(this.dirtyStart,s),this.dirtyEnd=Math.max(this.dirtyEnd,s)):y.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")}lock(){this.pixelType===g.ld.UNSIGNED_BYTE&&this._shared&&T.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,1)}unlock(){this.pixelType===g.ld.UNSIGNED_BYTE&&this._shared&&T.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,0)}expand(e){if(this.size=e,!this.textureOnly){const t=this._initData(this.pixelType,e,this._shared,this._ctype),r=this.data;t.set(r),this.data=t}}toMessage(){const e=this.dirtyStart,t=this.dirtyEnd,r=this.texelSize;if(e>t)return null;this._resetRange();const s=!(this._shared||"local"===this._ctype),n=this.pixelType,i=this.layout,o=this.data;return{start:e,end:t,data:s&&o.slice(e*r,(t+1)*r)||null,pixelType:n,layout:i}}_initData(e,t,r,s){const n=r&&"local"!==s?SharedArrayBuffer:ArrayBuffer,i=(0,m.Qz)(e),o=new i(new n(t*t*4*i.BYTES_PER_ELEMENT));for(let a=0;a<o.length;a+=4)o[a+1]=255;return o}_resetRange(){this.dirtyStart=2147483647,this.dirtyEnd=0}}class A{constructor(e,t){this._client=e,this.config=t,this.updatingHandles=new d.N,this._blocks=new Array,this._filters=new Array(h.R6),this._attributeComputeInfo=null,this._targetType=0,this._abortController=new AbortController,this._hasScaleExpr=!1,this._size=32,this._nextUpdate=null,this._currUpdate=null,this._idsToHighlight=new Set;const r=t.supportsTextureFloat?g.ld.FLOAT:g.ld.UNSIGNED_BYTE;I(`Creating AttributeStore ${T.sharedArrayBuffer?"with":"without"} shared memory`),this._blockDescriptors=[{pixelType:g.ld.UNSIGNED_BYTE,layout:1},{pixelType:g.ld.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:g.ld.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:r,layout:15},{pixelType:r,layout:15},{pixelType:r,layout:15},{pixelType:r,layout:15}],this._blocks=this._blockDescriptors.map((()=>null))}destroy(){this._abortController.abort(),this.updatingHandles.destroy()}get hasScaleExpr(){return this._hasScaleExpr}get _signal(){return this._abortController.signal}get hasHighlight(){return this._idsToHighlight.size>0}isUpdating(){const e=this.updatingHandles.updating||!!this._nextUpdate;return(0,n.A)("geoscene-2d-log-updating")&&console.log(`Updating AttributeStore: ${e}\n  -> updatingHandles ${this.updatingHandles.updating} (currUpdate: ${!!this._currUpdate})\n  -> nextUpdate: ${!!this._nextUpdate}\n`),e}update(e,t){this.config=t;const r=t.schema.processors[0].storage,s=(0,c.Ui)(this._schema,r);if((e.targets.feature||e.targets.aggregate)&&(e.storage.data=!0),s&&((0,n.A)("geoscene-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",s),e.storage.data=!0,this._schema=r,this._attributeComputeInfo=null,null!=r)){switch(r.target){case"feature":this._targetType=f.Ph;break;case"aggregate":this._targetType=f.Yh}if("subtype"===r.type){this._attributeComputeInfo={isSubtype:!0,subtypeField:r.subtypeField,map:new Map};for(const e in r.mapping){const t=r.mapping[e];if(null!=t&&null!=t.vvMapping)for(const r of t.vvMapping)this._bindAttribute(r,parseInt(e,10))}}else{if(this._attributeComputeInfo={isSubtype:!1,map:new Map},null!=r.vvMapping)for(const e of r.vvMapping)this._bindAttribute(e);if(null!=r.attributeMapping)for(const e of r.attributeMapping)this._bindAttribute(e)}}}onTileData(e,t){if(null==t.addOrUpdate)return;const r=t.addOrUpdate.getCursor();for(;r.next();){const e=r.getDisplayId();this.setAttributeData(e,r)}}async setHighlight(e,t){const r=1,s=this._getBlock(0),n=t.map((e=>(0,f.Q4)(e)));s.lock(),s.unsetComponentAllTexels(0,r),s.setComponent(0,r,n),s.unlock(),this._idsToHighlight.clear();for(const i of e)this._idsToHighlight.add(i);await this.sendUpdates()}async updateFilters(e,t,r){(0,n.A)("geoscene-2d-update-debug")&&console.debug("AttributeStore::updateFilters");const{service:s,spatialReference:i}=r,{filters:o}=t,a=o.map(((e,t)=>this._updateFilter(e,t,s,i))),u=(await Promise.all(a)).some((e=>e));(0,n.A)("geoscene-2d-update-debug")&&console.debug("AttributeStore::updateFilters - finsihed"),u&&(e.storage.filters=!0,(0,n.A)("geoscene-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))}setData(e,t,r,s){const n=(0,f.Q4)(e);this._ensureSizeForTexel(n),this._getBlock(t).setData(e,r,s)}getData(e,t,r){return this._getBlock(t).getData(e,r)}getHighlightFlag(e){return this._idsToHighlight.has(e)?h.mZ:0}unsetAttributeData(e){const t=(0,f.Q4)(e);this._getBlock(0).setData(t,0,0)}setAttributeData(e,t){const r=(0,f.Q4)(e);if(this._ensureSizeForTexel(r),this._getBlock(0).setData(r,0,this.getFilterFlags(t)),this._targetType!==(0,f.qP)(e))return;const s=this._attributeComputeInfo,n=this.config.supportsTextureFloat?1:2,i=4;let a=null;s&&(a=s.isSubtype?s.map.get(t.readAttribute(s.subtypeField)):s.map,a&&a.size&&a.forEach(((e,s)=>{const a=s*n%i,u=Math.floor(s*n/i),c=this._getBlock(u+h.pK),d=e(t);if(this.config.supportsTextureFloat)c.setData(r,a,d);else if(d===h.ah)c.setData(r,a,255),c.setData(r,a+1,255);else{const e=(0,o.qE)(Math.round(d),-32767,32766)+32768,t=255&e,s=(65280&e)>>8;c.setData(r,a,t),c.setData(r,a+1,s)}})))}sendUpdates(){if((0,n.A)("geoscene-2d-update-debug")&&console.debug("AttributeStore::sendUpdate"),this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=(0,u.Tw)(),this.updatingHandles.addPromise(this._nextUpdate.promise),this._nextUpdate.promise;const e={blocks:this._blocks.map((e=>null!=e?e.toMessage():null))};return this._currUpdate=this._createResources().then((()=>{const t=()=>{if(this._currUpdate=null,this._nextUpdate){const e=this._nextUpdate;this._nextUpdate=null,this.sendUpdates().then((()=>e.resolve()))}else(0,n.A)("geoscene-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::No additional updates queued")};(0,n.A)("geoscene-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");const r=this.updatingHandles.addPromise(this._client.update(e,this._signal).then(t).catch(t));return this._client.render(this._signal),r})).catch((e=>{if((0,u.zf)(e))return this._createResourcesPromise=null,this._createResources();y.error(new s.A("mapview-attribute-store","Encountered an error during client update",e))})),this._currUpdate}_ensureSizeForTexel(e){for(;e>=this._size*this._size;)if(this._expand())return}_bindAttribute(e,t){function r(){const{normalizationField:t}=e;return t?r=>{const s=r.readAttribute(t);return s?r.readAttribute(e.field)/s:null}:t=>t.readAttribute(e.field)}function s(){return e.normalizationField&&y.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported."),t=>t.getComputedNumericAtIndex(e.fieldIndex)}let n;if(null!=e.fieldIndex)n=s();else{if(!e.field)return;n=r()}const{valueRepresentation:i}=e;i&&(n=x(n,(e=>(0,_.lS)(e,i))));const o=e=>null===e||isNaN(e)||e===1/0||e===-1/0?h.ah:e,a=this._attributeComputeInfo;if(a.isSubtype){const r=a.map.get(t)??new Map;r.set(e.binding,x(n,o)),a.map.set(t,r)}else a.map.set(e.binding,x(n,o))}_createResources(){if(null!=this._createResourcesPromise)return this._createResourcesPromise;this._getBlock(h.Rs),this._getBlock(h.Qf),I("Initializing AttributeStore");const e={shared:T.sharedArrayBuffer&&!("local"===this._client.type),size:this._size,blocks:(0,a.Cv)(this._blocks,(e=>({textureOnly:e.textureOnly,buffer:e.buffer,pixelType:e.pixelType})))},t=this._client.initialize(e,this._signal).catch((e=>{(0,u.zf)(e)?this._createResourcesPromise=null:y.error(new s.A("mapview-attribute-store","Encountered an error during client initialization",e))}));return this._createResourcesPromise=t,t.then((()=>null==this._createResourcesPromise?this._createResources():void 0)),t}_getBlock(e){const t=this._blocks[e];if(null!=t)return t;I(`Initializing AttributeBlock at index ${e}`);const r=T.sharedArrayBuffer,s=this._client.type,n=new b(r,s,this._size,this._blockDescriptors[e]);return this._blocks[e]=n,this._createResourcesPromise=null,n}_expand(){if(this._size<this.config.maxTextureSize){const e=this._size<<=1;return I("Expanding block size to",e,this._blocks),(0,a.rj)(this._blocks,(t=>t.expand(e))),this._createResourcesPromise=null,this._size=e,0}return y.error(new s.A("mapview-limitations","Maximum number of onscreen features exceeded.")),-1}async _updateFilter(e,t,r,s){const n=this._filters[t],i=null!=n&&n.hash;if(!n&&!e)return!1;if(i===JSON.stringify(e))return!1;if(null==e){if(!n)return!1;const e=1<<t+1,r=this._getBlock(0);return this._filters[t]=null,r.setComponentAllTexels(0,e),this.sendUpdates(),!0}const o=await this._getFilter(t,r);return await o.update(e,s),!0}async _getFilter(e,t){const s=this._filters[e];if(null!=s)return s;const{default:n}=await r.e(3630).then(r.bind(r,33630)),i=new n({geometryType:t.geometryType,hasM:!1,hasZ:!1,timeInfo:t.timeInfo,fieldsIndex:new l.A(t.fields)});return this._filters[e]=i,i}isVisible(e){return!!(2&this._getBlock(0).getData(e,0))}getFilterFlags(e){let t=0;const r=(0,f.KG)(e.getDisplayId());for(let n=0;n<this._filters.length;n++){const s=!!(r&1<<n),i=this._filters[n];t|=(!s||null==i||i.check(e)?1:0)<<n}let s=0;if(this._idsToHighlight.size){const t=e.getObjectId();s=this.getHighlightFlag(t)}return t<<1|s}}},43569:function(e,t,r){r.d(t,{l:function(){return a}});r(44114);var s=r(54168);class n{constructor(){this._freeIds=[],this._idCounter=1}createId(e=!1){return(0,s.Ss)(this._getFreeId(),e)}releaseId(e){this._freeIds.push(e)}_getFreeId(){return this._freeIds.length?this._freeIds.pop():this._idCounter++}}var i=r(8526);function o(e,t,r){if(!(e.length>t))for(;e.length<=t;)e.push(r)}class a{constructor(){this._numerics=[],this._strings=[],this._idGenerator=new n,this._allocatedSize=256,this._bitsets=[],this._instanceIds=[],this._bounds=[]}createBitset(){const e=this._bitsets.length;return this._bitsets.push(i.y.create(this._allocatedSize,s.zT)),e+1}getBitset(e){return this._bitsets[e-1]}_expand(){this._allocatedSize<<=1;for(const e of this._bitsets)e.resize(this._allocatedSize)}_ensureNumeric(e,t){this._numerics[e]||(this._numerics[e]=[]),o(this._numerics[e],t,0)}_ensureInstanceId(e){o(this._instanceIds,e,0)}_ensureString(e,t){this._strings[e]||(this._strings[e]=[]),o(this._strings[e],t,null)}createDisplayId(e=!1){const t=this._idGenerator.createId();return t>this._allocatedSize&&this._expand(),(0,s.Ss)(t,e)}releaseDisplayId(e){for(const t of this._bitsets)t.unset(e);return this._idGenerator.releaseId(e&s.zT)}getComputedNumeric(e,t){return this.getComputedNumericAtIndex(e&s.zT,0)}setComputedNumeric(e,t,r){return this.setComputedNumericAtIndex(e&s.zT,r,0)}getComputedString(e,t){return this.getComputedStringAtIndex(e&s.zT,0)}setComputedString(e,t,r){return this.setComputedStringAtIndex(e&s.zT,0,r)}getComputedNumericAtIndex(e,t){const r=e&s.zT;return this._ensureNumeric(t,r),this._numerics[t][r]}setComputedNumericAtIndex(e,t,r){const n=e&s.zT;this._ensureNumeric(t,n),this._numerics[t][n]=r}getInstanceId(e){const t=e&s.zT;return this._ensureInstanceId(t),this._instanceIds[t]}setInstanceId(e,t){const r=e&s.zT;this._ensureInstanceId(r),this._instanceIds[r]=t}getComputedStringAtIndex(e,t){const r=e&s.zT;return this._ensureString(t,r),this._strings[t][r]}setComputedStringAtIndex(e,t,r){const n=e&s.zT;this._ensureString(t,n),this._strings[t][n]=r}getXMin(e){return this._bounds[4*(e&s.zT)]}getYMin(e){return this._bounds[4*(e&s.zT)+1]}getXMax(e){return this._bounds[4*(e&s.zT)+2]}getYMax(e){return this._bounds[4*(e&s.zT)+3]}setBounds(e,t){const r=t.readHydratedGeometry();if(!r||!r.coords.length)return!1;let n=1/0,i=1/0,a=-1/0,u=-1/0;r.forEachVertex(((e,t)=>{n=Math.min(n,e),i=Math.min(i,t),a=Math.max(a,e),u=Math.max(u,t)}));const c=e&s.zT;return o(this._bounds,4*c+4,0),this._bounds[4*c]=n,this._bounds[4*c+1]=i,this._bounds[4*c+2]=a,this._bounds[4*c+3]=u,!0}}},85344:function(e,t,r){r.d(t,{Y:function(){return S}});r(44114),r(2516);var s=r(66140),n=r(75417),i=r(51020),o=r(79908),a=r(99939),u=r(41312),c=r(47086),d=r(8526),l=r(55772);let h=0;const f=(0,i.A)("featurelayer-simplify-thresholds")??[.5,.5,.5,.5],m=f[0],p=f[1],_=f[2],g=f[3],y=(0,i.A)("featurelayer-simplify-payload-size-factors")??[1,2,4],I=y[0],T=y[1],x=y[2],b=(0,i.A)("featurelayer-simplify-mobile-factor")??2,A=(0,i.A)("geoscene-mobile");class S{constructor(e,t){this.type="FeatureSetReader",this.arcadeDeclaredClass="geoscene.arcade.Feature",this.seen=!1,this.instance=0,this._tx=0,this._ty=0,this._sx=1,this._sy=1,this._deleted=null,this._joined=[],this._objectIdToIndex=null,this._level=0,this._datetimeMetadata=null,this.contextTimeReference=null,this.instance=e,this._layerSchema=t}static createInstance(){return h++,h=h>65535?0:h,h}get isEmpty(){return null!=this._deleted&&this._deleted.countSet()===this.getSize()}set level(e){this._level=e}getAreaSimplificationThreshold(e,t){let r=1;const s=A?b:1;t>4e6?r=x*s:t>1e6?r=T*s:t>5e5?r=I*s:t>1e5&&(r=s);let n=0;e>4e3?n=g*r:e>2e3?n=_*r:e>100?n=p:e>15&&(n=m);let i=8;return this._level<4?i=1:this._level<5?i=2:this._level<6&&(i=4),n*i}createQuantizedExtrudedQuad(e,t){return new c.A([5],[e-1,t,1,-1,1,1,-1,1,-1,-1])}parseTimestampOffset(e){return e}setArcadeSpatialReference(e){this._arcadeSpatialReference=e}attachStorage(e){this._storage=e}getQuantizationTransform(){throw new Error("Unable to find transform for featureSet")}getStorage(){return this._storage}getComputedNumeric(e){return this.getComputedNumericAtIndex(0)}setComputedNumeric(e,t){return this.setComputedNumericAtIndex(t,0)}getComputedString(e){return this.getComputedStringAtIndex(0)}setComputedString(e,t){return this.setComputedStringAtIndex(0,t)}getComputedNumericAtIndex(e){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),e)}setComputedNumericAtIndex(e,t){this._storage.setComputedNumericAtIndex(this.getDisplayId(),e,t)}getComputedStringAtIndex(e){return this._storage.getComputedStringAtIndex(this.getDisplayId(),e)}setComputedStringAtIndex(e,t){return this._storage.setComputedStringAtIndex(this.getDisplayId(),e,t)}transform(e,t,r,s){const n=this.copy();return n._tx+=e,n._ty+=t,n._sx*=r,n._sy*=s,n}readAttribute(e,t=!1){const r=this._readAttribute(e,t);if(void 0!==r)return r;for(const s of this._joined){s.setIndex(this.getIndex());const r=s._readAttribute(e,t);if(void 0!==r)return r}}readAttributes(){const e=this._readAttributes();for(const t of this._joined){t.setIndex(this.getIndex());const r=t._readAttributes();for(const t of Object.keys(r))e[t]=r[t]}return e}joinAttributes(e){this._joined.push(e)}readArcadeFeature(){return this}hasField(e){return this.fields.has(e)}geometry(){const e=this.readHydratedGeometry(),t=(0,u.zv)(e,this.geometryType,this.hasZ,this.hasM),r=(0,l.rS)(t);return r&&(r.spatialReference=this._arcadeSpatialReference),r}get dateTimeReferenceFieldIndex(){return this._datetimeMetadata||(this._datetimeMetadata=n.vN.create(this._layerSchema.fields,this._layerSchema)),this._datetimeMetadata}autocastArcadeDate(e,t){return t&&t instanceof Date?this.isUnknownDateTimeField(e)?s.lY.unknownDateJSToArcadeDate(t):s.lY.dateJSAndZoneToArcadeDate(t,this.contextTimeReference?.timeZone??"system"):t}isUnknownDateTimeField(e){return"unknown"===this.dateTimeReferenceFieldIndex?.fieldTimeZone(e)}fieldSourceTimeZone(e){return this.dateTimeReferenceFieldIndex?.fieldTimeZone(e)??""}get layerPreferredTimeZone(){return this.dateTimeReferenceFieldIndex?.layerPreferredTimeZone??""}field(e){if(this.hasField(e))return this.autocastArcadeDate(e,this.readAttribute(e,!0));for(const t of this._joined)if(t.setIndex(this.getIndex()),t.hasField(e)){const r=t._readAttribute(e,!0);return this.autocastArcadeDate(e,r)}throw new Error(`Field ${e} does not exist`)}setField(e,t){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this.fields.fields.map((e=>e.name))}castToText(e=!1){if(!e)return JSON.stringify(this.readLegacyFeature());const t=this.readLegacyFeature();if(!t)return JSON.stringify(null);const r={geometry:t.geometry,attributes:{...t.attributes??{}}};for(const s in r.attributes){const e=r.attributes[s];e instanceof Date&&(r.attributes[s]=e.getTime())}return JSON.stringify(r)}gdbVersion(){return null}fullSchema(){return this._layerSchema}castAsJson(e=null){return{attributes:this._readAttributes(),geometry:!0===e?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(e=null,t=null){return Promise.resolve(this.castAsJson(t))}removeIds(e){if(null==this._objectIdToIndex){const e=new Map,t=this.getCursor();for(;t.next();){const r=(0,o.T7)(t.getObjectId());e.set(r,t.getIndex())}this._objectIdToIndex=e}const t=this._objectIdToIndex;for(const r of e)t.has(r)&&this.removeAtIndex(t.get(r))}removeAtIndex(e){null==this._deleted&&(this._deleted=d.y.create(this.getSize())),this._deleted.set(e)}readGeometryForDisplay(){return this.readUnquantizedGeometry(!0)}readLegacyGeometryForDisplay(){return this.readLegacyGeometry(!0)}*features(){const e=this.getCursor();for(;e.next();)yield e.readOptimizedFeature()}_getExists(){return null==this._deleted||!this._deleted.has(this.getIndex())}_computeCentroid(){if("esriGeometryPolygon"!==this.geometryType)return null;const e=this.readUnquantizedGeometry();if(!e||e.hasIndeterminateRingOrder)return null;const t=this.getQuantizationTransform()??null;return(0,a.Q)(new c.A,e,this.hasM,this.hasZ,t)}copyInto(e){e.seen=this.seen,e._storage=this._storage,e._arcadeSpatialReference=this._arcadeSpatialReference,e._joined=this._joined,e._tx=this._tx,e._ty=this._ty,e._sx=this._sx,e._sy=this._sy,e._deleted=this._deleted,e._objectIdToIndex=this._objectIdToIndex}}},35698:function(e,t,r){r.d(t,{K:function(){return u}});r(44114),r(17642),r(58004),r(33853),r(45876),r(32475),r(15024),r(31698);var s=r(41312),n=r(32066),i=r(27678),o=r(85344);function a({coords:e,lengths:t}){let r=0;for(const s of t){for(let t=1;t<s;t++)e[2*(r+t)]+=e[2*(r+t)-2],e[2*(r+t)+1]+=e[2*(r+t)-1];r+=s}}class u extends o.Y{static fromFeatures(e,t){const{objectIdField:r,geometryType:n}=t,i=(0,s.Di)([],e,n,!1,!1,r);for(let s=0;s<i.length;s++)i[s].displayId=e[s].displayId;return u.fromOptimizedFeatures(i,t)}static fromFeatureSet(e,t){const r=(0,s.q3)(e,t.objectIdField);return u.fromOptimizedFeatureSet(r,t)}static fromOptimizedFeatureSet(e,t){const{features:r}=e,s=u.fromOptimizedFeatures(r,t);return s._exceededTransferLimit=e.exceededTransferLimit,s._transform=e.transform,s._fieldsIndex=new i.A(t.fields),s}static fromOptimizedFeatures(e,t,r){const s=o.Y.createInstance(),n=new u(s,e,t);return n._fieldsIndex=new i.A(t.fields),n._transform=r,n}constructor(e,t,r){super(e,r),this._exceededTransferLimit=!1,this._featureIndex=-1,this._fieldsIndex=null,this._geometryType=r?.geometryType,this._features=t}get fields(){return this._fieldsIndex}get _current(){return this._features[this._featureIndex]}get geometryType(){return this._geometryType}get hasFeatures(){return!!this._features.length}get hasNext(){return this._featureIndex+1<this._features.length}get exceededTransferLimit(){return this._exceededTransferLimit}get hasZ(){return!1}get hasM(){return!1}removeIds(e){const t=new Set(e);this._features=this._features.filter((e=>!(null!=e.objectId&&t.has(e.objectId))))}append(e){for(const t of e)this._features.push(t)}getSize(){return this._features.length}getCursor(){return this.copy()}getQuantizationTransform(){return this._transform}getAttributeHash(){let e="";for(const t in this._current.attributes)e+=this._current.attributes[t];return e}getIndex(){return this._featureIndex}setIndex(e){this._featureIndex=e}getObjectId(){return this._current?.objectId}getDisplayId(){return this._current.displayId}setDisplayId(e){this._current.displayId=e}getGroupId(){return this._current.groupId}setGroupId(e){this._current.groupId=e}copy(){const e=new u(this.instance,this._features,this.fullSchema());return this.copyInto(e),e}next(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length}readLegacyFeature(){return(0,s.oN)(this._current,this.geometryType,this.hasZ,this.hasM)}readOptimizedFeature(){return this._current}readLegacyPointGeometry(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null}readLegacyGeometry(){const e=this.readUnquantizedGeometry();return(0,s.zv)(e,this.geometryType,this.hasZ,this.hasM)}readLegacyCentroid(){const e=this.readCentroid();return null==e?null:{x:e.coords[0]*this._sx+this._tx,y:e.coords[1]*this._sy+this._ty}}readGeometryArea(){return(0,n.N3)(this._current)?(0,s.Rk)(this._current.geometry,2):0}readUnquantizedGeometry(){const e=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!e)return e;const t=e.clone();return a(t),t}readHydratedGeometry(){const e=this._current.geometry;if(null==e)return null;const t=e.clone();return null!=this._transform&&(0,s.Ch)(t,t,this.hasZ,this.hasM,this._transform),t}getXHydrated(){if(!(0,n.N3)(this._current))return 0;const e=this._current.geometry.coords[0],t=this.getQuantizationTransform();return null==t?e:e*t.scale[0]+t.translate[0]}getYHydrated(){if(!(0,n.N3)(this._current))return 0;const e=this._current.geometry.coords[1],t=this.getQuantizationTransform();return null==t?e:t.translate[1]-e*t.scale[1]}getX(){return(0,n.N3)(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:0}getY(){return(0,n.N3)(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0}readGeometry(){if(!(0,n.N3)(this._current)){if(null!=this._current.centroid){const[e,t]=this._current.centroid.coords;return this.createQuantizedExtrudedQuad(e,t)}return null}const e=this._current.geometry.clone();if(e.isPoint)return e.coords[0]=e.coords[0]*this._sx+this._tx,e.coords[1]=e.coords[1]*this._sy+this._ty,e;let t=0;for(const r of e.lengths)e.coords[2*t]=e.coords[2*t]*this._sx+this._tx,e.coords[2*t+1]=e.coords[2*t+1]*this._sy+this._ty,t+=r;return e}readCentroid(){return(0,n.N3)(this._current)?this._computeCentroid():this._current.centroid}_readAttribute(e,t){const r=this._fieldsIndex.get(e);if(!r)return;let s=this._current.attributes[r.name];return null==s?s:("esriFieldTypeTimestampOffset"===this.fields.get(e)?.type&&(s=this.parseTimestampOffset(s)),t&&this.fields.isDateField(e)?new Date(s):s)}copyInto(e){super.copyInto(e),e._featureIndex=this._featureIndex,e._transform=this._transform,e._fieldsIndex=this._fieldsIndex}_readAttributes(){return this._current.attributes}}},8526:function(e,t,r){r.d(t,{y:function(){return s}});r(16573),r(78100),r(77936),r(37467),r(44732),r(79577);class s{static fromBuffer(e,t){return new s(e,t)}static create(e,t=4294967295){const r=new Uint32Array(Math.ceil(e/32));return new s(r,t)}constructor(e,t){this._mask=0,this._buf=e,this._mask=t}_getIndex(e){return Math.floor(e/32)}has(e){const t=this._mask&e;return!!(this._buf[this._getIndex(t)]&1<<t%32)}hasRange(e,t){let r=e,s=t;for(;r%32&&r!==s;){if(this.has(r))return!0;r++}for(;s%32&&r!==s;){if(this.has(r))return!0;s--}if(r===s)return!1;for(let n=r/32;n!==s/32;n++)if(this._buf[n])return!0;return!1}set(e){const t=this._mask&e,r=this._getIndex(t),s=1<<t%32;this._buf[r]|=s}setRange(e,t){let r=e,s=t;for(;r%32&&r!==s;)this.set(r++);for(;s%32&&r!==s;)this.set(s--);if(r!==s)for(let n=r/32;n!==s/32;n++)this._buf[n]=4294967295}unset(e){const t=this._mask&e,r=this._getIndex(t),s=1<<t%32;this._buf[r]&=4294967295^s}resize(e){const t=this._buf,r=new Uint32Array(Math.ceil(e/32));r.set(t),this._buf=r}or(e){for(let t=0;t<this._buf.length;t++)this._buf[t]|=e._buf[t];return this}and(e){for(let t=0;t<this._buf.length;t++)this._buf[t]&=e._buf[t];return this}xor(e){for(let t=0;t<this._buf.length;t++)this._buf[t]^=e._buf[t];return this}ior(e){for(let t=0;t<this._buf.length;t++)this._buf[t]|=~e._buf[t];return this}iand(e){for(let t=0;t<this._buf.length;t++)this._buf[t]&=~e._buf[t];return this}ixor(e){for(let t=0;t<this._buf.length;t++)this._buf[t]^=~e._buf[t];return this}any(){for(let e=0;e<this._buf.length;e++)if(this._buf[e])return!0;return!1}copy(e){for(let t=0;t<this._buf.length;t++)this._buf[t]=e._buf[t];return this}clone(){return new s(this._buf.slice(),this._mask)}clear(){for(let e=0;e<this._buf.length;e++)this._buf[e]=0}forEachSet(e){for(let t=0;t<this._buf.length;t++){let r=this._buf[t],s=32*t;if(r)for(;r;)1&r&&e(s),r>>>=1,s++}}countSet(){let e=0;return this.forEachSet((t=>{e++})),e}}}}]);
//# sourceMappingURL=7084.88d1bba4.js.map