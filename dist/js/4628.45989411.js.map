{"version":3,"file":"js/4628.45989411.js","mappings":"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","sources":["webpack://sun-glare-project/./node_modules/@geoscene/core/layers/support/ExportWMSImageParameters.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/2d/engine/Bitmap.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/2d/engine/BitmapContainer.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/2d/engine/ImageryBitmapSource.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/layers/WMSLayerView.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/2d/layers/WMSLayerView2D.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/2d/viewStateUtils.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/2d/layers/support/ExportStrategy.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/layers/RefreshableLayerView.js"],"sourcesContent":["/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";const a={visible:\"visibleSublayers\"};let l=class extends(s(r)){constructor(e){super(e),this.scale=0}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.sublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"wms-sublayer-update\",(e=>this.notifyChange(a[e.propertyName])))],\"layer\"))}get layers(){return this.visibleSublayers.filter((({name:e})=>e)).map((({name:e})=>e)).join()}get version(){this.commitProperty(\"layers\");const e=this.layer;return e&&e.commitProperty(\"imageTransparency\"),(this._get(\"version\")||0)+1}get visibleSublayers(){const{layer:e,scale:r}=this,s=e?.sublayers,t=[],o=e=>{const{minScale:s,maxScale:a,sublayers:l,visible:i}=e;i&&(0===r||(0===s||r<=s)&&(0===a||r>=a))&&(l?l.forEach(o):t.push(e))};return s?.forEach(o),t}toJSON(){const{layer:e,layers:r}=this,{imageFormat:s,imageTransparency:t,version:o}=e;return{format:s,request:\"GetMap\",service:\"WMS\",styles:\"\",transparent:t?\"TRUE\":\"FALSE\",version:o,layers:r}}};e([t()],l.prototype,\"layer\",null),e([t({readOnly:!0})],l.prototype,\"layers\",null),e([t({type:Number})],l.prototype,\"scale\",void 0),e([t({readOnly:!0})],l.prototype,\"version\",null),e([t({readOnly:!0})],l.prototype,\"visibleSublayers\",null),l=e([o(\"geoscene.layers.support.ExportWMSImageParameters\")],l);export{l as ExportWMSImageParameters};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{applySome as t}from\"../../../core/maybe.js\";import{createResolver as e,onAbortOrThrow as s,throwIfNotAbortError as i}from\"../../../core/promiseUtils.js\";import{g as r,h,r as o,l as u,m as a}from\"../../../chunks/mat3.js\";import{c as n}from\"../../../chunks/mat3f32.js\";import{f as d}from\"../../../chunks/vec2f32.js\";import{DisplayObject as l}from\"./DisplayObject.js\";import c from\"./ImageryBitmapSource.js\";import{ContextType as _}from\"../../webgl/contextUtils.js\";import{SizedPixelFormat as p,PixelFormat as m,TextureWrapMode as x}from\"../../webgl/enums.js\";import{Texture as g}from\"../../webgl/Texture.js\";import{TextureDescriptor as f}from\"../../webgl/TextureDescriptor.js\";function w(t){return t&&\"render\"in t}function b(t){const e=document.createElement(\"canvas\");return e.width=t.width,e.height=t.height,t.render(e.getContext(\"2d\")),e}function v(e){return w(e)?e instanceof c?t(e.getRenderedRasterPixels(),(t=>t.renderedRasterPixels)):b(e):e}class T extends l{constructor(t=null,e=!1){super(),this.blendFunction=\"standard\",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this._texture=null,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.immutable=e,this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){null==t&&null==this._source||(this._source=t,this.invalidateTexture(),this.requestRender())}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t)}async setSourceAsync(t,i){null!=this._uploadStatus&&this._uploadStatus.controller.abort();const r=new AbortController,h=e();return s(i,(()=>r.abort())),s(r,(t=>h.reject(t))),this._uploadStatus={controller:r,resolver:h},this.source=t,h.promise}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}updateTransitionProperties(t,e){t>=64&&(this.fadeTransitionEnabled=!1,this.inFadeTransition=!1),super.updateTransitionProperties(t,e)}setTransform(t){const e=r(this.transforms.dvs),[s,i]=t.toScreenNoRotation([0,0],[this.x,this.y]),n=this.resolution/this.pixelRatio/t.resolution,l=n*this.width,c=n*this.height,_=Math.PI*this.rotation/180;h(e,e,d(s,i)),h(e,e,d(l/2,c/2)),o(e,e,-_),h(e,e,d(-l/2,-c/2)),u(e,e,d(l,c)),a(this.transforms.dvs,t.displayViewMat3,e)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind(t,e){this._texture&&t.bindTexture(this._texture,e)}async updateTexture({context:t,painter:e}){if(!this._textureInvalidated)return;if(this._textureInvalidated=!1,this._texture||(this._texture=this._createTexture(t)),!this.source)return void this._texture.setData(null);this._texture.resize(this._sourceWidth,this._sourceHeight);const s=v(this.source);try{if(null!=this._uploadStatus){const{controller:t,resolver:i}=this._uploadStatus,r={signal:t.signal},{width:h,height:o}=this,u=this._texture,a=e.textureUploadManager;await a.enqueueTextureUpdate({data:s,texture:u,width:h,height:o},r),i.resolve(),this._uploadStatus=null}else this._texture.setData(s);this.ready()}catch(r){i(r)}}onDetach(){this.destroy()}_createTransforms(){return{dvs:n()}}_createTexture(t){const e=this.immutable&&t.type===_.WEBGL2,s=new f;return s.internalFormat=e?p.RGBA8:m.RGBA,s.wrapMode=x.CLAMP_TO_EDGE,s.isImmutable=e,s.width=this._sourceWidth,s.height=this._sourceHeight,new g(t,s)}}export{T as Bitmap,w as isImageSource,b as rasterize};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{brushes as e}from\"./brushes.js\";import{WGLDrawPhase as s}from\"./webgl/enums.js\";import r from\"./webgl/WGLContainer.js\";class a extends r{constructor(){super(...arguments),this._hasCrossfade=!1}get requiresDedicatedFBO(){return this._hasCrossfade}beforeRender(e){super.beforeRender(e),this._manageFade()}prepareRenderPasses(r){const a=r.registerRenderPass({name:\"bitmap\",brushes:[e.bitmap],target:()=>this.children,drawPhase:s.MAP});return[...super.prepareRenderPasses(r),a]}_manageFade(){this.children.reduce(((e,s)=>e+(s.inFadeTransition?1:0)),0)>=2?(this.children.forEach((e=>e.blendFunction=\"additive\")),this._hasCrossfade=!0):(this.children.forEach((e=>e.blendFunction=\"standard\")),this._hasCrossfade=!1)}}export{a as BitmapContainer};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nclass l{constructor(l,e,t){this.pixelBlock=l,this.extent=e,this.originalPixelBlock=t}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(l){const e=this.pixelBlock;if(null==e)return;const t=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??e});if(null==t.pixelBlock)return;t.pixelBlock.maskIsAlpha&&(t.pixelBlock.premultiplyAlpha=!0);const i=t.pixelBlock.getAsRGBA(),h=l.createImageData(t.pixelBlock.width,t.pixelBlock.height);h.data.set(i),l.putImageData(h,0,0)}getRenderedRasterPixels(){const l=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==l.pixelBlock?null:(l.pixelBlock.maskIsAlpha&&(l.pixelBlock.premultiplyAlpha=!0),{width:l.pixelBlock.width,height:l.pixelBlock.height,renderedRasterPixels:new Uint8Array(l.pixelBlock.getAsRGBA().buffer)})}}export{l as default};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{destroyMaybe as t}from\"../../core/maybe.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as p}from\"../../layers/support/commonProperties.js\";import{ExportWMSImageParameters as a}from\"../../layers/support/ExportWMSImageParameters.js\";const i=i=>{let m=class extends i{initialize(){this.exportImageParameters=new a({layer:this.layer})}destroy(){this.exportImageParameters=t(this.exportImageParameters)}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}fetchPopupFeatures(e){const{layer:t}=this;if(!e)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:t}));const{popupEnabled:o}=t;if(!o)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"popupEnabled should be true\",{popupEnabled:o}));const s=this.createFetchPopupFeaturesQuery(e);if(!s)return Promise.resolve([]);const{extent:p,width:a,height:i,x:m,y:n}=s;if(!(p&&a&&i))throw new r(\"wmslayerview:fetchPopupFeatures\",\"WMSLayer does not support fetching features.\",{extent:p,width:a,height:i});return t.fetchFeatureInfo(p,a,i,m,n)}};return e([o()],m.prototype,\"exportImageParameters\",void 0),e([o({readOnly:!0})],m.prototype,\"exportImageVersion\",null),e([o()],m.prototype,\"layer\",void 0),e([o(p)],m.prototype,\"timeExtent\",void 0),m=e([s(\"geoscene.layers.mixins.WMSLayerView\")],m),m};export{i as default};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Logger.js\";import{destroyMaybe as r}from\"../../../core/maybe.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as s}from\"../../../core/reactiveUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import p from\"../../../geometry/Extent.js\";import{BitmapContainer as n}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as m}from\"./LayerView2D.js\";import h from\"./support/ExportStrategy.js\";import c from\"../../layers/LayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";import u from\"../../layers/WMSLayerView.js\";let y=class extends(u(d(m(c)))){constructor(){super(...arguments),this.bitmapContainer=new n}supportsSpatialReference(e){return this.layer.serviceSupportsSpatialReference(e)}update(e){this.strategy.update(e).catch((e=>{i(e)||t.getLogger(this).error(e)}))}attach(){const{layer:e}=this,{imageMaxHeight:t,imageMaxWidth:r}=e;this.bitmapContainer=new n,this.container.addChild(this.bitmapContainer),this.strategy=new h({container:this.bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:t,imageMaxWidth:r,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.addAttachHandles(s((()=>this.exportImageVersion),(()=>this.requestUpdate())))}detach(){this.strategy=r(this.strategy),this.container.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(e){const{view:t,bitmapContainer:r}=this,{x:i,y:s}=e,{spatialReference:a}=t;let o,n=0,m=0;if(r.children.some((e=>{const{width:t,height:r,resolution:h,x:c,y:d}=e,u=c+h*t,y=d-h*r;return i>=c&&i<=u&&s<=d&&s>=y&&(o=new p({xmin:c,ymin:y,xmax:u,ymax:d,spatialReference:a}),n=t,m=r,!0)})),!o)return null;const h=o.width/n,c=Math.round((i-o.xmin)/h),d=Math.round((o.ymax-s)/h);return{extent:o,width:n,height:m,x:c,y:d}}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImageBitmap(e,t,r,{timeExtent:this.timeExtent,...i})}};e([a()],y.prototype,\"strategy\",void 0),e([a()],y.prototype,\"updating\",void 0),y=e([o(\"geoscene.views.2d.layers.WMSLayerView2D\")],y);const g=y;export{g as default};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nconst t=Math.PI/180;function n(n){return n*t}function o(t,o){const a=n(o.rotation),r=Math.abs(Math.cos(a)),s=Math.abs(Math.sin(a)),[u,c]=o.size;return t[0]=Math.round(c*s+u*r),t[1]=Math.round(c*r+u*s),t}function a(t,n,o,a){const[r,s]=n,[u,c]=a,h=.5*o;return t[0]=r-h*u,t[1]=s-h*c,t[2]=r+h*u,t[3]=s+h*c,t}export{a as getBBox,o as getOuterSize};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../core/Accessor.js\";import\"../../../../core/has.js\";import{debounce as i,throwIfAborted as o,throwIfAbortError as r,eachAlways as s}from\"../../../../core/promiseUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import{subclass as p}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{create as n,toExtent as m}from\"../../../../geometry/support/aaBoundingRect.js\";import{getInfo as l}from\"../../../../geometry/support/spatialReferenceUtils.js\";import h from\"../../../../layers/support/TileInfo.js\";import{getOuterSize as d,getBBox as c}from\"../../viewStateUtils.js\";import{Bitmap as u}from\"../../engine/Bitmap.js\";import g from\"../../tiling/TileInfoView.js\";import f from\"../../tiling/TileKey.js\";const y=n(),x=[0,0],S=new f(0,0,0,0),_={container:null,fetchSource:null,requestUpdate:null,imageMaxWidth:2048,imageMaxHeight:2048,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1};let w=class extends e{constructor(t){super(t),this._imagePromise=null,this.bitmaps=[],this.hidpi=_.hidpi,this.imageMaxWidth=_.imageMaxWidth,this.imageMaxHeight=_.imageMaxHeight,this.imageRotationSupported=_.imageRotationSupported,this.imageNormalizationSupported=_.imageNormalizationSupported,this.update=i((async(t,e)=>{if(o(e),!t.stationary||this.destroyed)return;const i=t.state,s=l(i.spatialReference),a=this.hidpi?t.pixelRatio:1,p=this.imageNormalizationSupported&&i.worldScreenWidth&&i.worldScreenWidth<i.size[0],n=this.imageMaxWidth??0,m=this.imageMaxHeight??0;p?(x[0]=i.worldScreenWidth,x[1]=i.size[1]):this.imageRotationSupported?(x[0]=i.size[0],x[1]=i.size[1]):d(x,i);const h=Math.floor(x[0]*a)>n||Math.floor(x[1]*a)>m,c=s&&(i.extent.xmin<s.valid[0]||i.extent.xmax>s.valid[1]),u=!this.imageNormalizationSupported&&c,g=!h&&!u,f=this.imageRotationSupported?i.rotation:0,y=this.container.children.slice();if(g){const t=p?i.paddedViewState.center:i.center;this._imagePromise&&console.error(\"Image promise was not defined!\"),this._imagePromise=this._singleExport(i,x,t,i.resolution,f,a,e)}else{let t=Math.min(n,m);u&&(t=Math.min(i.worldScreenWidth,t)),this._imagePromise=this._tiledExport(i,t,a,e)}try{const t=await this._imagePromise??[];o(e);const i=[];if(this._imagePromise=null,this.destroyed)return;this.bitmaps=t;for(const e of y)t.includes(e)||i.push(e.fadeOut().then((()=>{e.remove(),e.destroy()})));for(const e of t)i.push(e.fadeIn());await Promise.all(i)}catch(S){this._imagePromise=null,r(S)}}),5e3),this.updateExports=i((async t=>{const e=[];for(const i of this.container.children){if(!i.visible||!i.stage)return;e.push(t(i).then((()=>{i.invalidateTexture(),i.requestRender()})))}this._imagePromise=s(e).then((()=>this._imagePromise=null)),await this._imagePromise}))}destroy(){this.bitmaps.forEach((t=>t.destroy())),this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}async _export(t,e,i,r,s,a){const p=await this.fetchSource(t,Math.floor(e*s),Math.floor(i*s),{rotation:r,pixelRatio:s,signal:a});o(a);const n=new u(null,!0);return n.x=t.xmin,n.y=t.ymax,n.resolution=t.width/e,n.rotation=r,n.pixelRatio=s,n.opacity=0,this.container.addChild(n),await n.setSourceAsync(p,a),o(a),n}async _singleExport(t,e,i,o,r,s,a){c(y,i,o,e);const p=m(y,t.spatialReference);return[await this._export(p,e[0],e[1],r,s,a)]}_tiledExport(t,e,i,o){const r=h.create({size:e,spatialReference:t.spatialReference,scales:[t.scale]}),s=new g(r),a=s.getTileCoverage(t);if(!a)return null;const p=[];return a.forEach(((r,a,n,l)=>{S.set(r,a,n,0),s.getTileBounds(y,S);const h=m(y,t.spatialReference);p.push(this._export(h,e,e,0,i,o).then((t=>(0!==l&&(S.set(r,a,n,l),s.getTileBounds(y,S),t.x=y[0],t.y=y[3]),t))))})),Promise.all(p)}};t([a()],w.prototype,\"_imagePromise\",void 0),t([a()],w.prototype,\"bitmaps\",void 0),t([a()],w.prototype,\"container\",void 0),t([a()],w.prototype,\"fetchSource\",void 0),t([a()],w.prototype,\"hidpi\",void 0),t([a()],w.prototype,\"imageMaxWidth\",void 0),t([a()],w.prototype,\"imageMaxHeight\",void 0),t([a()],w.prototype,\"imageRotationSupported\",void 0),t([a()],w.prototype,\"imageNormalizationSupported\",void 0),t([a()],w.prototype,\"requestUpdate\",void 0),t([a()],w.prototype,\"updating\",null),w=t([p(\"geoscene.views.2d.layers.support.ExportStrategy\")],w);const v=w;export{v as default};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/reactiveUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";const a=a=>{let c=class extends a{initialize(){this.handles.add(o((()=>this.layer),\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([i(\"geoscene.layers.mixins.RefreshableLayerView\")],c),c};export{a as default};"],"names":["a","visible","l","s","r","constructor","e","super","this","scale","layer","_get","_set","handles","remove","add","sublayers","on","notifyChange","propertyName","layers","visibleSublayers","filter","name","map","join","version","commitProperty","t","o","minScale","maxScale","i","forEach","push","toJSON","imageFormat","imageTransparency","format","request","service","styles","transparent","prototype","readOnly","type","Number","w","b","document","createElement","width","height","render","getContext","v","c","getRenderedRasterPixels","renderedRasterPixels","T","blendFunction","_sourceWidth","_sourceHeight","_textureInvalidated","_texture","stencilRef","coordScale","_height","pixelRatio","resolution","rotation","_source","_width","x","y","immutable","source","requestRender","bind","destroy","dispose","_uploadStatus","controller","abort","isSourceScaled","invalidateTexture","beforeRender","updateTexture","setSourceAsync","AbortController","h","reject","resolver","promise","HTMLImageElement","naturalHeight","naturalWidth","updateTransitionProperties","fadeTransitionEnabled","inFadeTransition","setTransform","transforms","dvs","toScreenNoRotation","n","_","Math","PI","d","u","displayViewMat3","setSamplingProfile","mips","descriptor","hasMipmap","generateMipmap","setSamplingMode","samplingMode","bindTexture","context","painter","_createTexture","setData","resize","signal","textureUploadManager","enqueueTextureUpdate","data","texture","resolve","ready","onDetach","_createTransforms","WEBGL2","f","internalFormat","p","RGBA8","m","RGBA","wrapMode","CLAMP_TO_EDGE","isImmutable","g","arguments","_hasCrossfade","requiresDedicatedFBO","_manageFade","prepareRenderPasses","registerRenderPass","brushes","bitmap","target","children","drawPhase","MAP","reduce","pixelBlock","extent","originalPixelBlock","maskIsAlpha","premultiplyAlpha","getAsRGBA","createImageData","set","putImageData","Uint8Array","buffer","initialize","exportImageParameters","exportImageVersion","fetchPopupFeatures","Promise","popupEnabled","createFetchPopupFeaturesQuery","fetchFeatureInfo","bitmapContainer","supportsSpatialReference","serviceSupportsSpatialReference","update","strategy","catch","getLogger","error","attach","imageMaxHeight","imageMaxWidth","container","addChild","fetchSource","fetchImage","requestUpdate","imageRotationSupported","imageNormalizationSupported","hidpi","addAttachHandles","detach","removeAllChildren","moveStart","viewChange","moveEnd","view","spatialReference","some","xmin","ymin","xmax","ymax","round","doRefresh","isUpdating","updating","updateRequested","fetchImageBitmap","timeExtent","abs","cos","sin","size","S","_imagePromise","bitmaps","async","stationary","destroyed","state","worldScreenWidth","floor","valid","slice","paddedViewState","center","console","_singleExport","min","_tiledExport","includes","fadeOut","then","fadeIn","all","updateExports","stage","_export","opacity","create","scales","getTileCoverage","getTileBounds","dataChanged"],"sourceRoot":""}