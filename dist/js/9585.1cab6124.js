"use strict";(self["webpackChunksun_glare_project"]=self["webpackChunksun_glare_project"]||[]).push([[9585],{42638:function(e,t,n){n.d(t,{el:function(){return j},mT:function(){return q}});n(44114);var s=n(19470),i=n(47966),r=n(15114),o=n(9737),l=n(68491),c=n(43166),h=n(72465),u=n(30075),a=(n(2516),n(86039)),f=n(55772),p=n(42116);async function g(e,t,n,s){const i=(0,p.Dl)(e),r=t[0].spatialReference,o={...s,query:{...i.query,f:"json",sr:JSON.stringify(r),target:JSON.stringify({geometryType:(0,f.$B)(t[0]),geometries:t}),cutter:JSON.stringify(n)}},l=await(0,a["default"])(i.path+"/cut",o),{cutIndexes:c,geometries:h=[]}=l.data;return{cutIndexes:c,geometries:h.map((e=>{const t=(0,f.rS)(e);return t.spatialReference=r,t}))}}var d=n(4244),m=n(63504);async function y(e,t,n){const s="string"==typeof e?(0,d.An)(e):e,i=t[0].spatialReference,r=(0,f.$B)(t[0]),o={...n,query:{...s.query,f:"json",sr:i.wkid??JSON.stringify(i),geometries:JSON.stringify((0,m.X)(t))}},{data:l}=await(0,a["default"])(s.path+"/simplify",o);return(0,m.V)(l.geometries,r,i)}const x=r.A.getLogger("geoscene.geometry.support.normalizeUtils");function w(e){return"polygon"===e.type}function A(e){return"polygon"===e[0].type}function I(e){return"polyline"===e[0].type}function R(e,t){if(!(e instanceof l.A||e instanceof o.A)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw x.error(e),new i.A(e)}const n=(0,c.r8)(e),s=[];for(const i of n){const e=[];s.push(e),e.push([i[0][0],i[0][1]]);for(let n=0;n<i.length-1;n++){const s=i[n][0],r=i[n][1],o=i[n+1][0],l=i[n+1][1],c=Math.sqrt((o-s)*(o-s)+(l-r)*(l-r)),h=(l-r)/c,u=(o-s)/c,a=c/t;if(a>1){for(let l=1;l<=a-1;l++){const n=l*t,i=u*n+s,o=h*n+r;e.push([i,o])}const n=(c+Math.floor(a-1)*t)/2,i=u*n+s,o=h*n+r;e.push([i,o])}e.push([o,l])}}return w(e)?new o.A({rings:s,spatialReference:e.spatialReference}):new l.A({paths:s,spatialReference:e.spatialReference})}function b(e,t,n){if(t){const t=R(e,1e6);e=(0,u.ci)(t,!0)}return n&&(e=(0,c.kS)(e,n)),e}function k(e,t,n){if(Array.isArray(e)){const s=e[0];if(s>t){const n=(0,c.kd)(s,t);e[0]=s+n*(-2*t)}else if(s<n){const t=(0,c.kd)(s,n);e[0]=s+t*(-2*n)}}else{const s=e.x;if(s>t){const n=(0,c.kd)(s,t);e=e.clone().offset(n*(-2*t),0)}else if(s<n){const t=(0,c.kd)(s,n);e=e.clone().offset(t*(-2*n),0)}}return e}function N(e,t){let n=-1;for(let s=0;s<t.cutIndexes.length;s++){const i=t.cutIndexes[s],r=t.geometries[s],o=(0,c.r8)(r);for(let e=0;e<o.length;e++){const t=o[e];t.some((n=>{if(n[0]<180)return!0;{let n=0;for(let e=0;e<t.length;e++){const s=t[e][0];n=s>n?s:n}n=Number(n.toFixed(9));const s=-360*(0,c.kd)(n,180);for(let i=0;i<t.length;i++){const t=r.getPoint(e,i);r.setPoint(e,i,t.clone().offset(s,0))}return!0}}))}if(i===n){if(A(e))for(const t of(0,c.r8)(r))e[i]=e[i].addRing(t);else if(I(e))for(const t of(0,c.r8)(r))e[i]=e[i].addPath(t)}else n=i,e[i]=r}return e}async function j(e,t,n){if(!Array.isArray(e))return j([e],t);t&&"string"!=typeof t&&x.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const i="string"==typeof t?t:t?.url??s.A.geometryServiceUrl;let r,a,f,p,d,m,w,A,I=0;const R=[],q=[];for(const s of e)if(null!=s)if(r||(r=s.spatialReference,a=(0,h.Vp)(r),f=r.isWebMercator,m=f?102100:4326,p=c.j7[m].maxX,d=c.j7[m].minX,w=c.j7[m].plus180Line,A=c.j7[m].minus180Line),a)if("mesh"===s.type)q.push(s);else if("point"===s.type)q.push(k(s.clone(),p,d));else if("multipoint"===s.type){const e=s.clone();e.points=e.points.map((e=>k(e,p,d))),q.push(e)}else if("extent"===s.type){const e=s.clone()._normalize(!1,!1,a);q.push(e.rings?new o.A(e):e)}else if(s.extent){const e=s.extent,t=(0,c.kd)(e.xmin,d)*(2*p);let n=0===t?s.clone():(0,c.kS)(s.clone(),t);e.offset(t,0),e.intersects(w)&&e.xmax!==p?(I=e.xmax>I?e.xmax:I,n=b(n,f),R.push(n),q.push("cut")):e.intersects(A)&&e.xmin!==d?(I=e.xmax*(2*p)>I?e.xmax*(2*p):I,n=b(n,f,360),R.push(n),q.push("cut")):q.push(n)}else q.push(s.clone());else q.push(s);else q.push(s);let F=(0,c.kd)(I,p),L=-90;const S=F,T=new l.A;for(;F>0;){const e=360*F-180;T.addPath([[e,L],[e,-1*L]]),L*=-1,F--}if(R.length>0&&S>0){const t=N(R,await g(i,R,T,n)),s=[],r=[];for(let n=0;n<q.length;n++){const i=q[n];if("cut"!==i)r.push(i);else{const i=t.shift(),o=e[n];null!=o&&"polygon"===o.type&&o.rings&&o.rings.length>1&&i.rings.length>=o.rings.length?(s.push(i),r.push("simplify")):r.push(f?(0,u.Gh)(i):i)}}if(!s.length)return r;const o=await y(i,s,n),l=[];for(let e=0;e<r.length;e++){const t=r[e];"simplify"!==t?l.push(t):l.push(f?(0,u.Gh)(o.shift()):o.shift())}return l}const G=[];for(let s=0;s<q.length;s++){const e=q[s];if("cut"!==e)G.push(e);else{const e=R.shift();G.push(!0===f?(0,u.Gh)(e):e)}}return G}function q(e,t){const n=(0,h.Vp)(t);if(n){const[t,s]=n.valid,i=s-t;if(e<t)for(;e<t;)e+=i;if(e>s)for(;e>s;)e-=i}return e}},43166:function(e,t,n){n.d(t,{j7:function(){return o},kS:function(){return c},kd:function(){return l},r8:function(){return h}});var s=n(68491),i=n(12790),r=n(55772);const o={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new s.A({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:i.A.WebMercator}),minus180Line:new s.A({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:i.A.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new s.A({paths:[[[180,-180],[180,180]]],spatialReference:i.A.WGS84}),minus180Line:new s.A({paths:[[[-180,-180],[-180,180]]],spatialReference:i.A.WGS84})}};function l(e,t){return Math.ceil((e-t)/(2*t))}function c(e,t){const n=h(e);for(const s of n)for(const e of s)e[0]+=t;return e}function h(e){return(0,r.Bi)(e)?e.rings:e.paths}},32066:function(e,t,n){n.d(t,{Ib:function(){return r},N3:function(){return i},Om:function(){return s}});class s{constructor(e=null,t={},n,s){this.geometry=e,this.attributes=t,this.centroid=n,this.objectId=s,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const e=new s(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}function i(e){return!(null==e.geometry||!e.geometry.coords||!e.geometry.coords.length)}class r extends s{}},83412:function(e,t,n){n.d(t,{A:function(){return s}});class s{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new s;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},47086:function(e,t,n){n.d(t,{A:function(){return s}});class s{constructor(e=[],t=[],n=!1){this.lengths=e??[],this.coords=t??[],this.hasIndeterminateRingOrder=n}static fromRect(e){const[t,n,i,r]=e,o=i-t,l=r-n;return new s([5],[t,n,o,0,0,l,-o,0,0,-l])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((e,t)=>e+t))}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let n=0;n<this.lengths.length;n++){const s=this.lengths[n];for(let n=0;n<s;n++)e(this.coords[2*(n+t)],this.coords[2*(n+t)+1]);t+=s}}clone(e){return e?(e.set(this.coords),new s(this.lengths.slice(),e,this.hasIndeterminateRingOrder)):new s(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}}}]);
//# sourceMappingURL=9585.1cab6124.js.map