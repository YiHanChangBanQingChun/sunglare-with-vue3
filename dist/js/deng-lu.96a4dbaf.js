"use strict";(self["webpackChunksun_glare_project"]=self["webpackChunksun_glare_project"]||[]).push([[3949],{29698:function(e,a,s){s.r(a),s.d(a,{default:function(){return Q}});var o=s(56768),l=s(45130),r=s(24232);const t={class:"deng-lu"},n={class:"login-container"},i=(0,o.Lk)("div",{class:"image-container"},[(0,o.Lk)("img",{src:"/login.png",alt:"Login Image"})],-1),u={class:"login-box"},d={class:"form-container"},c={class:"form-group"},g=(0,o.Lk)("label",{for:"username"},"用户名:",-1),p={class:"form-group"},v=(0,o.Lk)("label",{for:"password"},"密码:",-1),m={class:"button-group"},k={key:0,class:"modal-overlay"},L={class:"modal"},w=(0,o.Lk)("h2",null,"注册",-1),y={class:"form-group"},f=(0,o.Lk)("label",{for:"reg-username"},"用户名：",-1),b=(0,o.Lk)("span",{class:"note"},"注意：用户名只能使用2到10字符数的中文、数字、英文三种组合。",-1),h={class:"form-group"},R=(0,o.Lk)("label",{for:"reg-password"},"密码：",-1),U=(0,o.Lk)("span",{class:"note"},"注意：密码需要使用包含英文和数字的6到10字符数。",-1),V={class:"form-group"},C=(0,o.Lk)("label",{for:"reg-email"},"邮箱：",-1),K={class:"form-group"},j=(0,o.Lk)("label",{for:"reg-security-question"},"安全问题：",-1),P=(0,o.Lk)("span",{class:"note"},"注意：用于忘记密码时找回。",-1),J={class:"form-group"},A=(0,o.Lk)("label",{for:"reg-security-answer"},"回答：",-1),E={class:"form-group"},x=(0,o.Lk)("label",{for:"reg-birthday"},"生日：",-1),_={class:"button-group"};function S(e,a,s,S,T,q){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",t,[(0,o.Lk)("div",n,[i,(0,o.Lk)("div",u,[(0,o.Lk)("div",d,[(0,o.Lk)("div",c,[g,(0,o.bo)((0,o.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":a[0]||(a[0]=e=>S.loginUsername=e)},null,512),[[l.Jo,S.loginUsername]])])]),(0,o.Lk)("div",p,[v,(0,o.bo)((0,o.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":a[1]||(a[1]=e=>S.loginPassword=e)},null,512),[[l.Jo,S.loginPassword]])]),(0,o.Lk)("div",m,[(0,o.Lk)("button",{onClick:a[2]||(a[2]=e=>S.showRegisterModal=!0)},"没有账号，注册一个？"),(0,o.Lk)("button",{onClick:a[3]||(a[3]=(...a)=>e.resetPassword&&e.resetPassword(...a))},"忘记密码？"),(0,o.Lk)("button",{onClick:a[4]||(a[4]=(...e)=>S.login&&S.login(...e))},"登录")])])])]),S.showRegisterModal?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("div",L,[w,(0,o.Lk)("div",y,[f,(0,o.bo)((0,o.Lk)("input",{type:"text",id:"reg-username","onUpdate:modelValue":a[5]||(a[5]=e=>S.username=e),class:(0,r.C4)({"invalid-input":!S.isUsernameValid})},null,2),[[l.Jo,S.username]]),b]),(0,o.Lk)("div",h,[R,(0,o.bo)((0,o.Lk)("input",{type:"password",id:"reg-password","onUpdate:modelValue":a[6]||(a[6]=e=>S.password=e),class:(0,r.C4)({"invalid-input":!S.isPasswordValid})},null,2),[[l.Jo,S.password]]),U]),(0,o.Lk)("div",V,[C,(0,o.bo)((0,o.Lk)("input",{type:"email",id:"reg-email","onUpdate:modelValue":a[7]||(a[7]=e=>S.email=e),class:(0,r.C4)({"invalid-input":!S.isEmailValid})},null,2),[[l.Jo,S.email]])]),(0,o.Lk)("div",K,[j,(0,o.bo)((0,o.Lk)("input",{type:"text",id:"reg-security-question","onUpdate:modelValue":a[8]||(a[8]=e=>S.securityQuestion=e)},null,512),[[l.Jo,S.securityQuestion]]),P]),(0,o.Lk)("div",J,[A,(0,o.bo)((0,o.Lk)("input",{type:"text",id:"reg-security-answer","onUpdate:modelValue":a[9]||(a[9]=e=>S.securityAnswer=e)},null,512),[[l.Jo,S.securityAnswer]])]),(0,o.Lk)("div",E,[x,(0,o.bo)((0,o.Lk)("input",{type:"date",id:"reg-birthday","onUpdate:modelValue":a[10]||(a[10]=e=>S.birthday=e)},null,512),[[l.Jo,S.birthday]])]),(0,o.Lk)("div",_,[(0,o.Lk)("button",{onClick:a[11]||(a[11]=e=>S.showRegisterModal=!1)},"取消"),(0,o.Lk)("button",{onClick:a[12]||(a[12]=(...e)=>S.register&&S.register(...e))},"注册")])])])):(0,o.Q3)("",!0)],64)}s(44114);var T=s(90144),q=s(60782),z=s(81387),B={name:"LoginView",setup(){const e=(0,T.KR)(""),a=(0,T.KR)(""),s=(0,T.KR)(""),l=(0,T.KR)(""),r=(0,T.KR)(""),t=(0,T.KR)(""),n=(0,T.KR)(""),i=(0,T.KR)(""),u=(0,T.KR)(!1),d=(0,T.KR)(!0),c=(0,T.KR)(!0),g=(0,T.KR)(!0),p=(0,q.Pj)(),v=(0,z.rd)(),m=()=>{e.value="",a.value="",s.value="",l.value="",r.value="",t.value=""},k=e=>{if(""===e)return!0;const a=/^[a-zA-Z0-9\u4e00-\u9fa5]{2,10}$/;return a.test(e)},L=()=>{d.value=k(e.value),console.log("Username valid:",d.value)};(0,o.wB)(e,L);const w=e=>{if(""===e)return!0;const a=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,10}$/;return a.test(e)},y=()=>{c.value=w(a.value),console.log("Password valid:",c.value)};(0,o.wB)(a,y);const f=e=>{if(""===e)return!0;const a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return a.test(e)},b=()=>{g.value=f(s.value),console.log("Email valid:",g.value)};(0,o.wB)(s,b);const h=async()=>{if(e.value&&a.value&&s.value&&l.value&&r.value&&t.value)if(d.value)if(c.value)if(g.value)try{const o={username:e.value,password:a.value,email:s.value,security_question:l.value,security_answer:r.value,birthday:t.value},n="http://112.125.122.56/sun-glare-project/api/register";console.log("API URL:",n),console.log("Request Body:",o);const i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(console.log("Response Status:",i.status),i.ok){const e=await i.json();console.log("Response Data:",e),alert(e.message),u.value=!1,m()}else if(400===i.status){const e=await i.json();console.log("Error Data:",e),"Username already exists"===e.message?alert("用户名已存在，请重新输入"):alert(e.message)}else{const e=await i.json();console.log("Error Data:",e),alert(e.message)}}catch(o){console.error("注册请求失败:",o),m(),alert("注册请求失败，请稍后再试。")}else alert("邮箱格式不正确");else alert("密码必须是6-10个字符，并包含字母和数字");else alert("用户名必须是2-10个字母、数字或汉字的组合");else alert("请填写所有字段")},R=async()=>{try{const e=await fetch("http://112.125.122.56/sun-glare-project/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n.value,password:i.value})});if(e.ok){const a=await e.json();alert(a.message),p.dispatch("login",{username:n.value,avatarUrl:"your-avatar-url"}),console.log("登录成功:",a),console.log("当前登录状态:",p.state),setTimeout((()=>{v.push({name:"yong-hu-zhong-xin"})}),3e3)}else{const a=await e.json();alert(a.message)}}catch(e){console.error("登录请求失败:",e),alert("登录请求失败，请稍后再试。")}},U=(0,o.EW)((()=>p.state.user));return{username:e,password:a,email:s,securityQuestion:l,securityAnswer:r,birthday:t,loginUsername:n,loginPassword:i,showRegisterModal:u,validateUsername:k,checkUsername:L,register:h,clearRegisterForm:m,isUsernameValid:d,isEmailValid:g,isPasswordValid:c,login:R,loggedInUser:U}}},M=s(71241);const O=(0,M.A)(B,[["render",S]]);var Q=O}}]);
//# sourceMappingURL=deng-lu.96a4dbaf.js.map