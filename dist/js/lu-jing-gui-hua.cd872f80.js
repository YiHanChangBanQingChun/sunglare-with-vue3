"use strict";(self["webpackChunksun_glare_project"]=self["webpackChunksun_glare_project"]||[]).push([[2854],{17522:function(e,t,s){s.r(t),s.d(t,{default:function(){return C}});var a=s(56768),n=s(45130),l=s(24232);const u={class:"lu-jing-gui-hua"},r=(0,a.Lk)("div",{class:"text"},[(0,a.Lk)("h1",null,"这个页面是放初始选项的")],-1),i={class:"search-containers"},c={class:"search-container start"},h={key:0,class:"search-results"},d=["onClick"],o={class:"search-container end"},g={key:0,class:"search-results"},p=["onClick"],y={class:"search-action"},k=(0,a.Lk)("div",{id:"viewDiv",style:{height:"560px"}},null,-1);function S(e,t,s,S,R,m){return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",u,[r,(0,a.Lk)("div",i,[(0,a.Lk)("div",c,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>R.searchQueryStart=e),onInput:t[1]||(t[1]=e=>m.onSearchInputChange(e,!0)),placeholder:"搜索起点...",class:"search-box search-box-start"},null,544),[[n.Jo,R.searchQueryStart]]),R.searchResults.length&&R.searchQueryStart?((0,a.uX)(),(0,a.CE)("div",h,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(R.searchResults,((e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:t,onClick:t=>m.selectResult(e,!0)},(0,l.v_)(e.name),9,d)))),128))])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",o,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>R.searchQueryEnd=e),onInput:t[3]||(t[3]=e=>m.onSearchInputChange(e,!1)),placeholder:"搜索终点...",class:"search-box search-box-end"},null,544),[[n.Jo,R.searchQueryEnd]]),R.searchResultsEnd.length&&R.searchQueryEnd?((0,a.uX)(),(0,a.CE)("div",g,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(R.searchResultsEnd,((e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:t,onClick:t=>m.selectResult(e,!1)},(0,l.v_)(e.name),9,p)))),128))])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",y,[(0,a.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>m.clcSearch&&m.clcSearch(...e))},"重新选择"),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>m.onSearch&&m.onSearch(...e))},"查询路径")])])]),k],64)}s(44114);var R=s(7382),m=s(56906),E=s(12790),_=s(2889),b={name:"RouteplanningView",data(){return{searchQueryStart:"",searchQueryEnd:"",searchResults:[],searchResultsEnd:[],selectedResultStart:null,selectedResultEnd:null}},mounted(){this.initMap()},methods:{clcSearch(){this.$router.push("/lu-jing-gui-hua")},initMap(){const e=new R.A({basemap:"tianditu-vector"}),t=new E.A({wkid:4326}),s=_.A.create({spatialReference:t,numLODs:32});this.createMapView(e,s)},onSearchInputChange(e,t){const s=e.target.value,a=t?"searchResults":"searchResultsEnd";s.includes("'")?console.log("输入法临时输入，不发送请求"):s.length>=2?fetch("http://127.0.0.1:5000/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({searchQueryStart:s})}).then((e=>e.json())).then((e=>{this[a]=e})).catch((e=>{console.error("错误:",e)})):this[a]=[]},selectResult(e,t=!0){console.log("用户选择了搜索结果:",e);const s={name:e.name,address:e.address,wgs84_latitude:e.wgs84_latitude,wgs84_longitude:e.wgs84_longitude,location:[e.wgs84_longitude,e.wgs84_latitude],baidu_index:e.baidu_index,baidu_latitude:e.baidu_latitude,baidu_longitude:e.baidu_longitude,id:e.id,label:e.label};t?(this.selectedResultStart=s,this.searchQueryStart=s.name,this.searchResults=[],this.$router.push({path:"/lu-jing-gui-hua/intermediate-page",query:{start:JSON.stringify(s)}})):(this.selectedResultEnd=s,this.searchQueryEnd=s.name,this.searchResultsEnd=[],this.$router.push({path:"/lu-jing-gui-hua/intermediate-page",query:{end:JSON.stringify(s)}}))},onSearch(){if(this.selectedResultStart&&this.selectedResultEnd){const e={...this.selectedResultStart,location:[this.selectedResultStart.wgs84_longitude,this.selectedResultStart.wgs84_latitude]},t={...this.selectedResultEnd,location:[this.selectedResultEnd.wgs84_longitude,this.selectedResultEnd.wgs84_latitude]};this.$router.push({path:"/lu-jing-gui-hua/result",query:{start:JSON.stringify(e),end:JSON.stringify(t)}})}else alert("请确保起点和终点都已选择。")},createMapView(e,t){return new m.A({map:e,center:[114.3,30.7],zoom:4,container:"viewDiv",constraints:{geometry:{type:"extent",xmin:113.6,ymin:29.9,xmax:115,ymax:31.3},minScale:500,maxScale:2e6,rotationEnabled:!1,lods:t.lods,snapToZoom:!1}})}}},w=s(71241);const v=(0,w.A)(b,[["render",S]]);var C=v}}]);
//# sourceMappingURL=lu-jing-gui-hua.cd872f80.js.map