{"version":3,"file":"js/lu-jing-gui-hua-result.39dbf3dd.js","mappings":"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","sources":["webpack://sun-glare-project/./src/views/RouteresultView.vue","webpack://sun-glare-project/./src/views/RouteresultView.vue?9414","webpack://sun-glare-project/./node_modules/@geoscene/core/layers/GraphicsLayer.js"],"sourcesContent":["<template>\r\n<div class=\"lu-jing-gui-hua\">\r\n  <div class=\"text\">\r\n    <h1>这个页面是放选中两点后的</h1>\r\n  </div>\r\n    <!-- 搜索框 -->\r\n    <!-- 外层容器 -->\r\n    <div class=\"search-containers\">\r\n     <div class=\"search-container start\">\r\n        <input type=\"text\" v-model=\"searchQueryStart\" @input=\"onSearchInputChange($event, true)\" placeholder=\"搜索起点...\" class=\"search-box search-box-start\"/>\r\n        <div class=\"search-results\" v-if=\"searchResults.length && searchQueryStart\">\r\n        <ul>\r\n            <li v-for=\"(result, index) in searchResults\" :key=\"index\" @click=\"selectResult(result, true)\">\r\n            {{ result.name }}\r\n            </li>\r\n        </ul>\r\n        </div>\r\n    </div>\r\n    <div class=\"search-container end\">\r\n        <input type=\"text\" v-model=\"searchQueryEnd\" @input=\"onSearchInputChange($event, false)\" placeholder=\"搜索终点...\" class=\"search-box search-box-end\"/>\r\n        <div class=\"search-results\" v-if=\"searchResultsEnd.length && searchQueryEnd\">\r\n        <ul>\r\n            <li v-for=\"(result, index) in searchResultsEnd\" :key=\"index\" @click=\"selectResult(result, false)\">\r\n            {{ result.name }}\r\n            </li>\r\n        </ul>\r\n        </div>\r\n    </div>\r\n    <div class=\"search-action\">\r\n      <button @click=\"clcSearch\">重新选择</button>\r\n        <button @click=\"onSearch\">查询路径</button>\r\n    </div>\r\n    <div v-if=\"isLoading\" class=\"loader-overlay\">\r\n      <div class=\"loader\"></div>\r\n    </div>\r\n    </div>\r\n    <!-- 地图容器 -->\r\n    <div id=\"mapViewDiv\" style=\"height: 560px;\"></div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport Map from '@geoscene/core/Map.js'\r\nimport MapView from '@geoscene/core/views/MapView.js'\r\nimport Graphic from '@geoscene/core/Graphic'\r\nimport Point from '@geoscene/core/geometry/Point.js'\r\nimport GraphicsLayer from '@geoscene/core/layers/GraphicsLayer'\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  name: 'RouteResultView',\r\n  data () {\r\n    return {\r\n      selectedResultStart: null,\r\n      selectedResultEnd: null,\r\n      searchResults: [],\r\n      searchResultsEnd: [],\r\n      searchQueryStart: '',\r\n      searchQueryEnd: '',\r\n      isLoading: false\r\n    }\r\n  },\r\n  mounted () {\r\n    // 初始化地图\r\n    this.initMap()\r\n    if (this.$route.query.start && this.$route.query.end) {\r\n      // 如果URL中有起点和终点参数，解析并设置\r\n      this.selectedResultStart = JSON.parse(this.$route.query.start)\r\n      this.selectedResultEnd = JSON.parse(this.$route.query.end)\r\n    }\r\n    // 解析URL参数\r\n    this.parseUrlParams()\r\n  },\r\n  methods: {\r\n    // 跳转到路径规划页面，清空搜索框\r\n    clcSearch () {\r\n      // 使用Vue Router进行页面跳转\r\n      this.$router.push('/lu-jing-gui-hua')\r\n    },\r\n    // 解析URL参数\r\n    parseUrlParams () {\r\n      const urlParams = new URLSearchParams(window.location.search)\r\n      const startParam = urlParams.get('start')\r\n      const endParam = urlParams.get('end')\r\n      // 如果有起点参数，进行解析\r\n      if (startParam) {\r\n        try {\r\n          // 解析起点参数\r\n          const startObj = JSON.parse(decodeURIComponent(startParam))\r\n          if (startObj && startObj.address) {\r\n            this.searchQueryStart = startObj.name\r\n          }\r\n        } catch (e) {\r\n          console.error('Error parsing start parameter:', e)\r\n        }\r\n      }\r\n      if (endParam) { // 如果有终点参数，进行解析\r\n        try {\r\n          // 解析终点参数\r\n          const endObj = JSON.parse(decodeURIComponent(endParam))\r\n          if (endObj && endObj.address) {\r\n            this.searchQueryEnd = endObj.name // 绑定终点查询字符串\r\n          }\r\n        } catch (e) {\r\n          console.error('Error parsing end parameter:', e)\r\n        }\r\n      }\r\n    },\r\n    // 处理搜索框输入事件\r\n    onSearchInputChange (event, isStart) {\r\n      const query = event.target.value\r\n      const searchResultsField = isStart ? 'searchResults' : 'searchResultsEnd'\r\n      if (query.includes(\"'\")) {\r\n        console.log('输入法临时输入，不发送请求')\r\n        return\r\n      }\r\n      if (query.length >= 2) {\r\n        fetch('http://127.0.0.1:5000/search', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify({ searchQueryStart: query })\r\n        })\r\n          .then(response => response.json())\r\n          .then(data => {\r\n            this[searchResultsField] = data\r\n          })\r\n          .catch((error) => {\r\n            console.error('错误:', error)\r\n          })\r\n      } else {\r\n        this[searchResultsField] = []\r\n      }\r\n    },\r\n    // 处理选择搜索结果事件\r\n    selectResult (result, isStart = true) {\r\n      console.log('用户选择了搜索结果:', result)\r\n      const simplifiedResult = {\r\n        name: result.name,\r\n        address: result.address,\r\n        wgs84_latitude: result.wgs84_latitude,\r\n        wgs84_longitude: result.wgs84_longitude,\r\n        location: [result.wgs84_longitude, result.wgs84_latitude],\r\n        baidu_index: result.baidu_index,\r\n        baidu_latitude: result.baidu_latitude,\r\n        baidu_longitude: result.baidu_longitude,\r\n        id: result.id,\r\n        label: result.label\r\n      }\r\n      // 根据isStart参数选择起点或终点\r\n      if (isStart) {\r\n        this.selectedResultStart = simplifiedResult\r\n        this.searchQueryStart = simplifiedResult.name\r\n        this.searchResults = []\r\n        // 跳转到结果页面，带上起点信息\r\n        this.$router.push({\r\n          path: '/lu-jing-gui-hua/intermediate-page',\r\n          query: {\r\n            start: JSON.stringify(simplifiedResult)\r\n          }\r\n        })\r\n      } else {\r\n        // 选择终点\r\n        this.selectedResultEnd = simplifiedResult\r\n        this.searchQueryEnd = simplifiedResult.name\r\n        this.searchResultsEnd = []\r\n        // 跳转到结果页面，带上终点信息\r\n        this.$router.push({\r\n          path: '/lu-jing-gui-hua/intermediate-page',\r\n          query: {\r\n            end: JSON.stringify(simplifiedResult)\r\n          }\r\n        })\r\n      }\r\n    },\r\n    // 处理路径规划事件\r\n    onSearch () {\r\n      // 检查是否两个结果都已选择\r\n      if (this.selectedResultStart && this.selectedResultEnd) {\r\n        // 显示加载动画\r\n        this.isLoading = true\r\n        // 构造包含location属性的起点和终点对象\r\n        const startWithLocation = {\r\n          ...this.selectedResultStart,\r\n          location: [this.selectedResultStart.wgs84_longitude, this.selectedResultStart.wgs84_latitude]\r\n        }\r\n        const endWithLocation = {\r\n          ...this.selectedResultEnd,\r\n          location: [this.selectedResultEnd.wgs84_longitude, this.selectedResultEnd.wgs84_latitude]\r\n        }\r\n        // 发送请求到后端进行路径规划\r\n        axios.post('http://127.0.0.1:5000/api/route/plan', { start: startWithLocation, end: endWithLocation })\r\n          .then(response => {\r\n            // 后端返回的路径规划结果ID\r\n            const routePlanId = response.data.id\r\n            console.log('路径规划结果ID:', routePlanId)\r\n\r\n            // 隐藏加载动画\r\n            this.isLoading = false\r\n\r\n            // 使用Vue Router跳转到结果页面，并传递路径规划结果ID\r\n            this.$router.push({\r\n              path: '/lu-jing-gui-hua/route',\r\n              query: {\r\n                start: JSON.stringify(startWithLocation),\r\n                end: JSON.stringify(endWithLocation),\r\n                id: routePlanId\r\n              }\r\n            })\r\n          })\r\n          .catch(error => {\r\n            console.error(error)\r\n            // 隐藏加载动画\r\n            this.isLoading = false\r\n            // 错误处理，例如显示提示信息\r\n            alert('路径规划失败，请稍后再试。')\r\n          })\r\n      } else {\r\n        // 如果起点或终点未选择，显示提示信息\r\n        alert('请确保起点和终点都已选择。')\r\n      }\r\n    },\r\n    // 初始化地图\r\n    initMap () {\r\n      const map = new Map({\r\n        basemap: 'tianditu-vector' // 使用适合的底图\r\n      })\r\n\r\n      // 创建MapView实例\r\n      this.view = new MapView({\r\n        container: 'mapViewDiv', // 使用正确的容器ID\r\n        map: map,\r\n        center: [114.3, 30.7], // 使用中心点坐标\r\n        zoom: 4,\r\n        constraints: {\r\n          geometry: {\r\n            type: 'extent',\r\n            xmin: 113.6,\r\n            ymin: 29.9,\r\n            xmax: 115.0,\r\n            ymax: 31.3\r\n          },\r\n          minScale: 500,\r\n          maxScale: 2000000,\r\n          rotationEnabled: false,\r\n          // 假设tileInfo.lods已经在某处定义，否则这里需要调整\r\n          // lods: tileInfo.lods,\r\n          snapToZoom: false\r\n        }\r\n      })\r\n      // 创建GraphicsLayer实例\r\n      const graphicsLayer = new GraphicsLayer()\r\n      map.add(graphicsLayer)\r\n\r\n      this.drawPoints(graphicsLayer)\r\n    },\r\n    // 在地图上绘制起点和终点\r\n    drawPoints (graphicsLayer) {\r\n      // 检查this.$route.query.start和this.$route.query.end是否定义\r\n      if (!this.$route.query.start || !this.$route.query.end) {\r\n        console.error('Start or end point is undefined.')\r\n        return // 如果未定义，直接返回\r\n      }\r\n      const start = JSON.parse(this.$route.query.start)\r\n      const end = JSON.parse(this.$route.query.end)\r\n      // 检查start和end是否有location属性\r\n      if (!start.location || !end.location) {\r\n        console.error('Start or end point does not have a location.')\r\n        return // 如果没有location属性，直接返回\r\n      }\r\n      // 创建起点和终点的Point实例\r\n      const startPoint = new Point({\r\n        longitude: start.location[0],\r\n        latitude: start.location[1]\r\n      })\r\n      const endPoint = new Point({\r\n        longitude: end.location[0],\r\n        latitude: end.location[1]\r\n      })\r\n      const startGraphic = new Graphic({\r\n        geometry: startPoint,\r\n        symbol: {\r\n          type: 'simple-marker', // autocasts as new SimpleMarkerSymbol()\r\n          color: 'green',\r\n          size: '20px'\r\n        },\r\n        // 添加popupTemplate，用url信息解析而来\r\n        popupTemplate: {\r\n          title: '起点信息',\r\n          content: [\r\n            {\r\n              type: 'fields',\r\n              fieldInfos: [\r\n                {\r\n                  fieldName: 'address',\r\n                  label: '地址'\r\n                },\r\n                {\r\n                  fieldName: 'name',\r\n                  label: '名称'\r\n                },\r\n                // 可以继续添加更多字段\r\n                {\r\n                  fieldName: 'wgs84_latitude',\r\n                  label: 'WGS84纬度'\r\n                },\r\n                {\r\n                  fieldName: 'wgs84_longitude',\r\n                  label: 'WGS84经度'\r\n                },\r\n                {\r\n                  fieldName: 'baidu_index',\r\n                  label: '百度索引'\r\n                },\r\n                {\r\n                  fieldName: 'baidu_latitude',\r\n                  label: '百度纬度'\r\n                },\r\n                {\r\n                  fieldName: 'baidu_longitude',\r\n                  label: '百度经度'\r\n                },\r\n                {\r\n                  fieldName: 'id',\r\n                  label: 'ID'\r\n                },\r\n                {\r\n                  fieldName: 'label',\r\n                  label: '标签'\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n        },\r\n        // 添加属性\r\n        attributes: start\r\n      })\r\n      const endGraphic = new Graphic({\r\n        geometry: endPoint,\r\n        symbol: {\r\n          type: 'simple-marker',\r\n          color: 'red',\r\n          size: '20px'\r\n        },\r\n        // 添加popupTemplate\r\n        popupTemplate: {\r\n          title: '起点信息',\r\n          content: [\r\n            {\r\n              type: 'fields',\r\n              fieldInfos: [\r\n                {\r\n                  fieldName: 'address',\r\n                  label: '地址'\r\n                },\r\n                {\r\n                  fieldName: 'name',\r\n                  label: '名称'\r\n                },\r\n                // 可以继续添加更多字段\r\n                {\r\n                  fieldName: 'wgs84_latitude',\r\n                  label: 'WGS84纬度'\r\n                },\r\n                {\r\n                  fieldName: 'wgs84_longitude',\r\n                  label: 'WGS84经度'\r\n                },\r\n                {\r\n                  fieldName: 'baidu_index',\r\n                  label: '百度索引'\r\n                },\r\n                {\r\n                  fieldName: 'baidu_latitude',\r\n                  label: '百度纬度'\r\n                },\r\n                {\r\n                  fieldName: 'baidu_longitude',\r\n                  label: '百度经度'\r\n                },\r\n                {\r\n                  fieldName: 'id',\r\n                  label: 'ID'\r\n                },\r\n                {\r\n                  fieldName: 'label',\r\n                  label: '标签'\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n        },\r\n        attributes: end\r\n      })\r\n      // 将起点和终点添加到图形图层\r\n      graphicsLayer.addMany([startGraphic, endGraphic])\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n/*之后要自己调样式的大小，这个仅作参考*/\r\n#viewDiv {\r\n  height: 100vh; /* 将高度设置为视口高度的80% */\r\n  width: 98vw; /* 将宽度设置为视口宽度的80% */\r\n  /*margin: auto;*/\r\n}\r\n\r\n.lu-jing-gui-hua {\r\n  display: flex;\r\n  flex-direction: column; /* 使子元素垂直排列 */\r\n  align-items: flex; /* 水平居中对齐子元素 */\r\n}\r\n\r\n.text > h1 {\r\n  text-align: center; /* 文本居中 */\r\n  background: -webkit-linear-gradient(rgba(238,174,202,1), rgba(148,187,233,1));\r\n  -webkit-background-clip: text;\r\n  -webkit-text-fill-color: transparent;\r\n  background-clip: text;\r\n  color: transparent; /* 对于非WebKit浏览器的兼容 */\r\n}\r\n\r\n.text {\r\n  margin-top: 5px; /* 顶部外边距 */\r\n  margin-bottom: 5px; /* 底部外边距 */\r\n  background: rgba(109, 72, 72, 0.45);\r\n  -webkit-backdrop-filter: blur(25px);\r\n  backdrop-filter: blur(25px);\r\n  border: 1px solid rgba(255,255,255,0.45);\r\n  border-radius: 15px; /* 添加圆角 */\r\n  padding: 20px; /* 内边距 */\r\n  text-align: left /* 文本居中 */\r\n}\r\n\r\n.search-containers {\r\n  display: flex;\r\n  flex-direction: column; /* 保持垂直排列 */\r\n  justify-content: flex-start; /* 从顶部开始排列 */\r\n  align-items: flex-start; /* 子元素沿交叉轴的开始边缘对齐，即顶部对齐 */\r\n  width: 50%; /* 设置一个固定宽度 */\r\n  padding: 10px; /* 根据需要调整，确保搜索框周围有足够空间 */\r\n  background-color: #f0f0f0; /* 背景颜色稍微深于白色 */\r\n  border-radius: 10px; /* 添加圆角边框 */\r\n  border: 1px solid #ccc; /* 添加边框 */\r\n  margin-bottom: 10px;\r\n  position: relative; /* 添加相对定位 */\r\n}\r\n\r\n/* 移除左右外边距 */\r\n.search-container.start,\r\n.search-container.end {\r\n  position: relative; /* 设置相对定位 */\r\n  margin: 0; /* 移除左右外边距 */\r\n  margin-top: 10px;\r\n}\r\n\r\n.search-box {\r\n  padding: 8px 15px; /* 初始内边距 */\r\n  border: 2px solid #ccc;\r\n  border-radius: 20px;\r\n  outline: none;\r\n  flex-grow: 1;\r\n  box-sizing: border-box;\r\n  text-indent: 0px; /* 初始文本缩进，保持文本在左侧 */\r\n  width: 180%; /* 使搜索框填充容器 */\r\n}\r\n\r\n/* 鼠标悬停时只改变边框颜色，不改变宽度 */\r\n.search-box:hover {\r\n  border-color: blue; /* 改变边框颜色而不是宽度 */\r\n}\r\n\r\n.search-box:focus {\r\n  padding-right: 60px; /* 聚焦时增加右侧内边距，使框向右变长 */\r\n  border-width: 2px;\r\n  border-color: blue;\r\n  transition: padding-right 0.3s ease, border-color 0.3s ease; /* 平滑过渡效果 */\r\n  text-indent: 0px; /* 聚焦时减少文本缩进 */\r\n}\r\n\r\n.search-results {\r\n  position: absolute;\r\n  top: 100%; /* 确保列表紧贴搜索框的底部 */\r\n  left: 0;\r\n  width: 180%; /* 使列表宽度与搜索框相同 */\r\n  background-color: white; /* 或其他背景色，确保列表可见 */\r\n  z-index: 1000; /* 确保搜索结果列表在其他元素之上 */\r\n  box-shadow: 0 4px 6px rgba(0,0,0,0.1); /* 可选：添加一些阴影以提升视觉效果 */\r\n  max-height: 160px; /* 限制最大高度，5行大约160px，根据实际行高调整 */\r\n  overflow-y: auto; /* 超出部分显示滚动条 */\r\n}\r\n\r\n.search-results li:hover {\r\n  text-decoration: underline; /* 添加下划线 */\r\n  background-color: #f0f0f0; /* 更改背景颜色以提高对比度 */\r\n  cursor: pointer; /* 更改鼠标指针为手形，更明显地指示可点击 */\r\n}\r\n\r\n/* 查询按钮的容器样式 */\r\n.search-action {\r\n  display: flex;\r\n  flex-direction: column; /* 修改为列布局 */\r\n  justify-content: flex-end; /* 使按钮靠右对齐 */\r\n  flex-grow: 1; /* 允许容器扩展填满剩余空间 */\r\n  align-self: flex-end; /* 使自己靠父容器的右边 */\r\n  margin-top: auto; /* 推到底部 */\r\n  position: absolute; /* 绝对定位 */\r\n  right: 10px; /* 与右边界保持一定距离 */\r\n  bottom: 10px; /* 与底部保持一定距离 */\r\n}\r\n\r\n/* 查询按钮样式 */\r\n.search-action button {\r\n  padding: 10px 20px; /* 按钮内边距 */\r\n  background-color: #007bff; /* 按钮背景颜色 */\r\n  color: white; /* 文字颜色 */\r\n  border: none; /* 去除边框 */\r\n  border-radius: 5px; /* 圆角边框 */\r\n  cursor: pointer; /* 鼠标悬停时显示指针 */\r\n  transition: background-color 0.3s; /* 背景颜色过渡效果 */\r\n  margin-top: 10px; /* 在按钮之间添加一些间距 */\r\n}\r\n\r\n/* 鼠标悬停在按钮上时的样式 */\r\n.search-action button:hover {\r\n  background-color: #0056b3; /* 按钮背景颜色变深 */\r\n}\r\n\r\n/* 第一个按钮（重新选择）不需要顶部间距 */\r\n.search-action button:first-child {\r\n  margin-top: 0;\r\n}\r\n\r\n/* 加载动画样式 */\r\n.loader-overlay {\r\n  position: fixed;\r\n  top: 50%;\r\n  left: 50%;\r\n  width: 30%;\r\n  height: 30%;\r\n  background: rgba(255, 255, 255, 0.8);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n  transform: translate(-50%, -50%);\r\n}\r\n\r\n/* 加载动画样式 */\r\n.loader {\r\n  width: 50px;\r\n  aspect-ratio: 1;\r\n  display: grid;\r\n  border-radius: 50%;\r\n  background:\r\n    linear-gradient(0deg ,rgb(0 0 0/50%) 30%,#0000 0 70%,rgb(0 0 0/100%) 0) 50%/8% 100%,\r\n    linear-gradient(90deg,rgb(0 0 0/25%) 30%,#0000 0 70%,rgb(0 0 0/75% ) 0) 50%/100% 8%;\r\n  background-repeat: no-repeat;\r\n  animation: l23 1s infinite steps(12);\r\n}\r\n\r\n/* 加载动画样式 */\r\n.loader::before,\r\n.loader::after {\r\n  content: \"\";\r\n  grid-area: 1/1;\r\n  border-radius: 50%;\r\n  background: inherit;\r\n  opacity: 0.915;\r\n  transform: rotate(30deg);\r\n}\r\n\r\n/* 加载动画样式 */\r\n.loader::after {\r\n  opacity: 0.83;\r\n  transform: rotate(60deg);\r\n}\r\n\r\n/* 加载动画样式 */\r\n@keyframes l23 {\r\n  100% {transform: rotate(1turn)}\r\n}\r\n\r\n/* 将CSS链接转换为@import语句 */\r\n@import url(\"https://js.geoscene.cn/4.27/@geoscene/core/assets/geoscene/themes/light/main.css\");\r\n</style>\r\n","import { render } from \"./RouteresultView.vue?vue&type=template&id=24e7ccce\"\nimport script from \"./RouteresultView.vue?vue&type=script&lang=js\"\nexport * from \"./RouteresultView.vue?vue&type=script&lang=js\"\n\nimport \"./RouteresultView.vue?vue&type=style&index=0&id=24e7ccce&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{_ as r}from\"../chunks/tslib.es6.js\";import{property as e}from\"../core/accessorSupport/decorators/property.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/arrayUtils.js\";import\"../core/has.js\";import{subclass as o}from\"../core/accessorSupport/decorators/subclass.js\";import{owningCollectionProperty as s}from\"../core/support/OwningCollection.js\";import t from\"./Layer.js\";import{BlendLayer as i}from\"./mixins/BlendLayer.js\";import{ScaleRangeLayer as p}from\"./mixins/ScaleRangeLayer.js\";import{GraphicsCollection as a}from\"../support/GraphicsCollection.js\";import c from\"../symbols/support/ElevationInfo.js\";let n=class extends(i(p(t))){constructor(r){super(r),this.elevationInfo=null,this.graphics=new a,this.screenSizePerspectiveEnabled=!0,this.type=\"graphics\",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(r){return this.graphics.add(r),this}addMany(r){return this.graphics.addMany(r),this}removeAll(){return this.graphics.removeAll(),this}remove(r){this.graphics.remove(r)}removeMany(r){this.graphics.removeMany(r)}on(r,e){return super.on(r,e)}graphicChanged(r){this.emit(\"graphic-update\",r)}};r([e({type:c})],n.prototype,\"elevationInfo\",void 0),r([e(s(a,\"graphics\"))],n.prototype,\"graphics\",void 0),r([e({type:[\"show\",\"hide\"]})],n.prototype,\"listMode\",void 0),r([e()],n.prototype,\"screenSizePerspectiveEnabled\",void 0),r([e({readOnly:!0})],n.prototype,\"type\",void 0),r([e({constructOnly:!0})],n.prototype,\"internal\",void 0),n=r([o(\"geoscene.layers.GraphicsLayer\")],n);const h=n;export{h as default};"],"names":["class","_createElementVNode","key","_hoisted_12","id","style","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","type","_cache","$event","$data","searchQueryStart","onInput","$options","onSearchInputChange","placeholder","searchResults","length","_hoisted_5","_Fragment","_renderList","result","index","onClick","selectResult","name","_hoisted_6","_createCommentVNode","_hoisted_7","searchQueryEnd","searchResultsEnd","_hoisted_8","_hoisted_9","_hoisted_10","args","clcSearch","onSearch","isLoading","_hoisted_11","_hoisted_13","_hoisted_14","data","selectedResultStart","selectedResultEnd","mounted","this","initMap","$route","query","start","end","JSON","parse","parseUrlParams","methods","$router","push","urlParams","URLSearchParams","window","location","search","startParam","get","endParam","startObj","decodeURIComponent","address","e","console","error","endObj","event","isStart","target","value","searchResultsField","includes","log","fetch","method","headers","body","stringify","then","response","json","catch","simplifiedResult","wgs84_latitude","wgs84_longitude","baidu_index","baidu_latitude","baidu_longitude","label","path","startWithLocation","endWithLocation","axios","post","routePlanId","alert","map","Map","basemap","view","MapView","container","center","zoom","constraints","geometry","xmin","ymin","xmax","ymax","minScale","maxScale","rotationEnabled","snapToZoom","graphicsLayer","GraphicsLayer","add","drawPoints","startPoint","Point","longitude","latitude","endPoint","startGraphic","Graphic","symbol","color","size","popupTemplate","title","content","fieldInfos","fieldName","attributes","endGraphic","addMany","__exports__","render","n","i","p","t","constructor","r","super","elevationInfo","graphics","a","screenSizePerspectiveEnabled","internal","destroy","removeAll","remove","removeMany","on","graphicChanged","emit","c","prototype","s","readOnly","constructOnly","o","h"],"sourceRoot":""}