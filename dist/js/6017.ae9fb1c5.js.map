{"version":3,"file":"js/6017.ae9fb1c5.js","mappings":"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","sources":["webpack://sun-glare-project/./node_modules/@geoscene/core/views/2d/engine/webgl/GroupContainer.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/layers/GroupLayerView.js","webpack://sun-glare-project/./node_modules/@geoscene/core/views/2d/layers/GroupLayerView2D.js"],"sourcesContent":["/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport e from\"./WGLContainer.js\";import{TextureSamplingMode as t}from\"../../../webgl/enums.js\";class r extends e{constructor(){super(...arguments),this._prevFBO=void 0,this.requiresDedicatedFBO=!1}dispose(){}doRender(e){const r=this.createRenderParams(e),{context:o,painter:s,profiler:n}=r;this._prevFBO=o.getBoundFramebufferObject(),n.recordContainerStart(this.name);const i=this._getFbo(r),a=s.getRenderTarget();o.bindFramebuffer(i),s.setRenderTarget(i),o.setDepthWriteEnabled(!0),o.setColorMask(!0,!0,!0,!0),o.setClearColor(0,0,0,0),o.setClearDepth(1),o.clear(o.gl.COLOR_BUFFER_BIT|o.gl.DEPTH_BUFFER_BIT),o.setDepthWriteEnabled(!1);for(const t of this.children)t.beforeRender(e);for(const t of this.children)t.processRender(r);for(const t of this.children)t.afterRender(e);s.setRenderTarget(a),s.releaseFbo(i),o.bindFramebuffer(this._prevFBO),s.beforeRenderLayer(r,this._clippingInfos?255:0,this.computedOpacity),i.colorTexture&&(o.setStencilTestEnabled(!1),o.setStencilWriteMask(0),s.blitTexture(o,i.colorTexture,t.NEAREST)),s.compositeLayer(r,this.computedOpacity),n.recordContainerEnd()}createRenderParams(e){return{...super.createRenderParams(e),blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:1}}_getFbo(e){const{context:t,painter:r}=e,{width:o,height:s}=t.getViewport();return r.acquireFbo(o,s)}}export{r as GroupContainer};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{_ as i}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Collection.js\";import{referenceSetter as s,castForReferenceSetter as r}from\"../../core/collectionUtils.js\";import{watch as t,sync as l}from\"../../core/reactiveUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as y}from\"../../core/accessorSupport/decorators/subclass.js\";import o from\"./LayerView.js\";let h=class extends o{constructor(i){super(i),this.type=\"group\",this.layerViews=new e}destroy(){this.handles.removeAll(),this.layerViews.length=0}_allLayerViewVisibility(i){this.layerViews.forEach((e=>{e.visible=i}))}initialize(){this.handles.add([this.layerViews.on(\"change\",(i=>this._layerViewsChangeHandler(i))),t((()=>this.layer?.visibilityMode),(()=>{this.layer&&this._applyVisibility((()=>this._allLayerViewVisibility(this.visible)),(()=>this._applyExclusiveVisibility(null)))}),l),t((()=>this.visible),(i=>{this._applyVisibility((()=>this._allLayerViewVisibility(i)),(()=>{}))}),l)],\"grouplayerview\"),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]})}set layerViews(i){this._set(\"layerViews\",s(i,this._get(\"layerViews\")))}get updatingProgress(){return 0===this.layerViews.length?1:this.layerViews.reduce(((i,e)=>i+e.updatingProgress),0)/this.layerViews.length}isUpdating(){return this.layerViews.some((i=>i.updating))}_hasLayerViewVisibleOverrides(){return this.layerViews.some((i=>i._isOverridden(\"visible\")))}_findLayerViewForLayer(i){return i&&this.layerViews.find((e=>e.layer===i))}_firstVisibleOnLayerOrder(){const i=this.layer.layers.find((i=>{const e=this._findLayerViewForLayer(i);return!!e?.visible}));return i&&this._findLayerViewForLayer(i)}_applyExclusiveVisibility(i){null==i&&null==(i=this._firstVisibleOnLayerOrder())&&this.layerViews.length>0&&(i=this._findLayerViewForLayer(this.layer.layers.at(0))),this.layerViews.forEach((e=>{e.visible=e===i}))}_layerViewsChangeHandler(i){this.handles.remove(\"grouplayerview:visible\"),this.handles.add(this.layerViews.map((i=>t((()=>i.visible),(e=>this._applyVisibility((()=>{e!==this.visible&&(i.visible=this.visible)}),(()=>this._applyExclusiveVisibility(e?i:null)))),l))).toArray(),\"grouplayerview:visible\");const e=i.added[i.added.length-1];this._applyVisibility((()=>this._allLayerViewVisibility(this.visible)),(()=>this._applyExclusiveVisibility(e?.visible?e:null)))}_applyVisibility(i,e){this._hasLayerViewVisibleOverrides()&&(\"inherited\"===this.layer?.visibilityMode?i():\"exclusive\"===this.layer?.visibilityMode&&e())}};i([a({cast:r})],h.prototype,\"layerViews\",null),i([a({readOnly:!0})],h.prototype,\"updatingProgress\",null),i([a()],h.prototype,\"view\",void 0),h=i([y(\"geoscene.views.layers.GroupLayerView\")],h);const n=h;export{n as default};","/*\r\nAll material copyright GeoScene, All Rights Reserved, unless otherwise specified.\r\nSee https://js.geoscene.cn/4.27/geoscene/copyright.txt for details.\r\n*/\r\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/Error.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import{GroupContainer as t}from\"../engine/webgl/GroupContainer.js\";import{LayerView2DMixin as s}from\"./LayerView2D.js\";import o from\"../../layers/GroupLayerView.js\";let a=class extends(s(o)){constructor(){super(...arguments),this.container=new t}attach(){this._updateStageChildren(),this.addAttachHandles(this.layerViews.on(\"after-changes\",(()=>this._updateStageChildren())))}detach(){this.container.removeAllChildren()}update(e){}moveStart(){}viewChange(){}moveEnd(){}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach(((e,r)=>this.container.addChildAt(e.container,r)))}};a=e([r(\"geoscene.views.2d.layers.GroupLayerView2D\")],a);const i=a;export{i as default};"],"names":["r","e","constructor","super","arguments","this","_prevFBO","requiresDedicatedFBO","dispose","doRender","createRenderParams","context","o","painter","s","profiler","n","getBoundFramebufferObject","recordContainerStart","name","i","_getFbo","a","getRenderTarget","bindFramebuffer","setRenderTarget","setDepthWriteEnabled","setColorMask","setClearColor","setClearDepth","clear","gl","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","t","children","beforeRender","processRender","afterRender","releaseFbo","beforeRenderLayer","_clippingInfos","computedOpacity","colorTexture","setStencilTestEnabled","setStencilWriteMask","blitTexture","NEAREST","compositeLayer","recordContainerEnd","blendMode","effects","computedEffects","globalOpacity","width","height","getViewport","acquireFbo","h","type","layerViews","destroy","handles","removeAll","length","_allLayerViewVisibility","forEach","visible","initialize","add","on","_layerViewsChangeHandler","layer","visibilityMode","_applyVisibility","_applyExclusiveVisibility","l","target","added","toArray","removed","moved","_set","_get","updatingProgress","reduce","isUpdating","some","updating","_hasLayerViewVisibleOverrides","_isOverridden","_findLayerViewForLayer","find","_firstVisibleOnLayerOrder","layers","at","remove","map","cast","prototype","readOnly","y","container","attach","_updateStageChildren","addAttachHandles","detach","removeAllChildren","update","moveStart","viewChange","moveEnd","addChildAt"],"sourceRoot":""}